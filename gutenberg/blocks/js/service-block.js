!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){e.exports=React},function(e,t,n){"use strict";n.r(t);var r=function(e,t,n,r){return new(n||(n=Promise))(function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})},a=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=wp.i18n.__,i=function(){function e(){}return e.searchCodes=function(e,t){var n=new URLSearchParams;return n.append("action","kunta_api_search_codes"),n.append("types",e),n.append("search",t),wp.apiFetch({url:ajaxurl,method:"POST",body:n})},e.findServiceChannel=function(e,t){if(!t)return null;var n=wp.apiFetch,r=new URLSearchParams;return r.append("action","kunta_api_load_"+{electronic:"electronic",phone:"phone",printableForm:"printable_form",webpage:"webpage",serviceLocation:"service_location"}[e]+"_service_channel"),r.append("id",t),n({url:ajaxurl,method:"POST",body:r})},e.searchOrganizations=function(e){var t=new URLSearchParams;return t.append("action","kunta_api_search_organizations"),t.append("search",this.splitSearchTerms(e)),wp.apiFetch({url:ajaxurl,method:"POST",body:t})},e.findOrganization=function(e){var t=new URLSearchParams;return t.append("action","kunta_api_find_organization"),t.append("id",e),wp.apiFetch({url:ajaxurl,method:"POST",body:t})},e.splitSearchTerms=function(e){return e?e.replace(/\ {1,}/g," ").split(" ").map(function(e){return"+("+e+"*)"}).join(" "):null},e.getCodeNameWithType=function(e){return this.getLocalizedValue(e.name||e.names,"fi")+" ("+this.getCodeTypeName(e.type)+")"},e.getMunicipalityNameWithType=function(e){return this.getLocalizedValue(e.names,"fi")+" ("+this.getCodeTypeName("Municipality")+")"},e.getLocalizedValue=function(e,t,n){if(!e)return null;for(var r=0;r<e.length;r++)if(t===e[r].language)return e[r][n||"value"];return null},e.getAnyLocalizedValue=function(e){for(var t=e.map(function(e){return e.locale}),n=0;n<t.length;n++){var r=this.getLocalizedValue(e,t[n]);if(r)return r}return null},e.loadLanguageCodes=function(t){return r(this,void 0,void 0,function(){var n,r,o;return a(this,function(a){switch(a.label){case 0:return(n=t.filter(function(e){return!!e}).map(function(e){return"code:"+e}).join(" "))?[4,e.searchCodes("Language","+("+n+")")]:[2,[]];case 1:return r=a.sent(),o={},r.forEach(function(t){o[t.code]=e.getLocalizedValue(t.names,"fi")}),[2,t.map(function(e){return{value:e,label:o[e]||e}})]}})})},e.loadAreas=function(t){return r(this,void 0,void 0,function(){var n,r;return a(this,function(a){switch(a.label){case 0:return n={},t.forEach(function(e){var t=e.split(":");n[t[0]]=(n[t[0]]||[]).concat("code:"+t[1])}),[4,Promise.all(Object.keys(n).map(function(t){var r=n[t].join(" ");return e.searchCodes(t,"+("+r+")")}))];case 1:return r=a.sent(),[2,[].concat.apply([],r)]}})})},e.getCodeTypeName=function(e){return o("codetype."+e,"kunta_api_core")},e.getDayName=function(e,t){var n={0:o("Sunday","kunta_api_core"),1:o("Monday","kunta_api_core"),2:o("Tuesday","kunta_api_core"),3:o("Wednesday","kunta_api_core"),4:o("Thursday","kunta_api_core"),5:o("Friday","kunta_api_core"),6:o("Saturday","kunta_api_core")},r={0:o("Sun.","kunta_api_core"),1:o("Mon.","kunta_api_core"),2:o("Tue.","kunta_api_core"),3:o("Wed.","kunta_api_core"),4:o("Thu.","kunta_api_core"),5:o("Fri.","kunta_api_core"),6:o("Sat.","kunta_api_core")};return t?r[e]:n[e]},e.formatDate=function(e){return moment(e).locale("fi").format("ll")},e.formatDateWithTime=function(e,t){var n=this.formatDate(e);return t?n+" "+t:n},e.formatDateWithTimes=function(e,t,n){var r=this.formatDateWithTime(e,t);return n?r+" - "+n:r},e.parseIsoDate=function(e){return e?new Date(Date.parse(e)):null},e}(),s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},c=function(e,t,n,r){return new(n||(n=Promise))(function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})},u=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},l=wp.data.registerStore,p={setService:function(e,t){return{type:"SET_SERVICE",serviceId:e,service:t}},setServiceChannel:function(e,t,n){return{type:"SET_SERVICE_CHANNEL",channelType:e,channelId:t,channel:n}},addPageChannel:function(e){return{type:"ADD_PAGE_CHANNEL",pageChannelId:e}},removePageChannel:function(e){return{type:"REMOVE_PAGE_CHANNEL",pageChannelId:e}}};l("kunta-api/data",{reducer:function(e,t){switch(void 0===e&&(e={services:{},pageChannelIds:[],serviceChannelTypeMap:{electronic:{},phone:{},printableForm:{},webpage:{},serviceLocation:{}}}),t.type){case"SET_SERVICE":var n=s({},e.services);return n[t.serviceId]=t.service,s({},e,{services:n});case"SET_SERVICE_CHANNEL":var r=s({},e.serviceChannelTypeMap);return r[t.channelType][t.channelId]=t.channel,s({},e,{serviceChannelTypeMap:r});case"ADD_PAGE_CHANNEL":return s({},e,{pageChannelIds:(e.pageChannelIds||[]).concat(t.pageChannelId)});case"REMOVE_PAGE_CHANNEL":return s({},e,{pageChannelIds:(e.pageChannelIds||[]).filter(function(e){return e!==t.pageChannelId})})}return e},actions:p,selectors:{getService:function(e,t){return e.services[t]},getServiceChannel:function(e,t,n){return e.serviceChannelTypeMap[t][n]},isPageChannel:function(e,t){return(e.pageChannelIds||[]).indexOf(t)>-1}},resolvers:{getService:function(e){return c(this,void 0,void 0,function(){var t,n,r;return u(this,function(a){switch(a.label){case 0:return t=wp.apiFetch,(n=new URLSearchParams).append("action","kunta_api_load_service"),n.append("serviceId",e),[4,t({url:ajaxurl,method:"POST",body:n})];case 1:return r=a.sent(),[2,p.setService(e,r)]}})})},getServiceChannel:function(e,t){return c(this,void 0,void 0,function(){var n,r,a;return u(this,function(o){switch(o.label){case 0:return r=(n=p).setServiceChannel,a=[e,t],[4,i.findServiceChannel(e,t)];case 1:return[2,r.apply(n,a.concat([o.sent()]))]}})})},isPageChannel:function(e){return wp.data.select("core/editor").getBlocks().filter(function(t){var n=t.attributes;return"kunta-api/service-location-service-channel"===t.name&&n&&n.pageChannelId==e&&n.serviceLocationPage}).length>0?p.addPageChannel(e):p.removePageChannel(e)}}});var h,d=n(0),f=n.n(d),v=(h=function(e,t){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),m=(wp.i18n.__,function(e){function t(t){var n=e.call(this,t)||this;return n.onInputChange=function(e){var t=wp.apiFetch,r=e.currentTarget.value;if(!(n.state.searching||r.length<3)){var a=new URLSearchParams;a.append("action",n.props.searchAction),a.append("search",i.splitSearchTerms(r)),n.setState({searching:!0}),t({url:ajaxurl,method:"POST",body:a}).then(function(e){n.setState({searching:!1,entities:e})})}},n.state={entities:[],searching:!1,hoverIndex:-1},n}return v(t,e),t.prototype.render=function(){var e=this;return f.a.createElement("div",{style:this.props.style},f.a.createElement(wp.components.BaseControl,{style:{width:"100%"},id:"search",label:this.props.inputLabel,help:this.props.inputHelp},f.a.createElement("input",{id:"search",style:{width:"100%"},onChange:this.onInputChange})),f.a.createElement("div",{style:{height:"300px",overflowY:"auto"}},this.state.searching?f.a.createElement(wp.components.Placeholder,{style:{height:"300px"}},f.a.createElement(wp.components.Spinner,null)):this.state.entities.map(function(t,n){return f.a.createElement("div",{onMouseOver:function(){return e.setState({hoverIndex:n})},onClick:function(){return e.props.onSelect(t)},style:{fontWeight:e.state.hoverIndex==n?"bold":"normal",cursor:"pointer",paddingTop:"5px",paddingBottom:"5px"},key:t.id},e.props.getDisplayName(t))})))},t}(f.a.Component)),y=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),g=(wp.i18n.__,function(e){function t(t){return e.call(this,t)||this}return y(t,e),t.prototype.onSelect=function(e){this.props.onSelect(e)},t.prototype.render=function(){var e=this;return this.props.open?f.a.createElement(wp.components.Modal,{style:{minWidth:"60%"},title:this.props.modalTitle,onRequestClose:function(){return e.props.onClose()}},f.a.createElement(m,{inputLabel:this.props.inputLabel,inputHelp:this.props.inputHelp,getDisplayName:this.props.getDisplayName,searchAction:this.props.searchAction,onSelect:function(t){return e.onSelect(t)},style:{width:"100%"}})):null},t}(f.a.Component)),b=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_=function(e,t,n,r){return new(n||(n=Promise))(function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})},S=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},w=(wp.i18n.__,kuntaApiBlocks.metaformsUrl),T=function(e){function t(t){var n=e.call(this,t)||this;return n.$metaform=null,n.state={json:null},n}return b(t,e),t.prototype.componentWillMount=function(){var e=this;this.loadForm().then(function(t){e.setState({json:t})})},t.prototype.componentDidUpdate=function(e,t){return _(this,void 0,void 0,function(){var n,r;return S(this,function(a){switch(a.label){case 0:return n=JSON.stringify(this.state.json)!==JSON.stringify(t.json),r=this.props.values!==e.values,n||r?(this.destroyForm(),this.$metaform=jQuery(this.refs.el).find("form.metaform").metaform().css({paddingBottom:"20px"}).on("change","input,select,textarea",this.onMetaformChange.bind(this)),this.props.afterFormRender?[4,this.props.afterFormRender(this,this.$metaform)]:[3,2]):[3,2];case 1:a.sent(),a.label=2;case 2:return this.checkValidity(),[2]}})})},t.prototype.componentWillUnmount=function(){this.destroyForm()},t.prototype.render=function(){return this.state.json&&this.props.values?f.a.createElement("div",{ref:"el",style:{maxHeight:"calc(80vh - 120px)",overflow:"scroll",marginTop:"-10px",marginLeft:"0px",marginRight:"0px",marginBottom:"0px"}},f.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.renderForm()}})):f.a.createElement(wp.components.Placeholder,{style:{height:"300px"}},f.a.createElement(wp.components.Spinner,null))},t.prototype.triggerChange=function(){this.checkValidity(),this.props.onValuesChange(this.getValues())},t.prototype.checkValidity=function(){if(this.props.onValidityChage){var e=this.$metaform[0].checkValidity();e!==this.props.valid&&this.props.onValidityChage(e)}},t.prototype.destroyForm=function(){this.$metaform&&this.$metaform.metaform("destroy")},t.prototype.renderForm=function(){return mfRender({viewModel:this.state.json,formValues:this.props.values})},t.prototype.getValues=function(){var e={};return this.$metaform.metaform("val",!0).forEach(function(t){e[t.name]=t.value}),e},t.prototype.onMetaformChange=function(e){this.triggerChange()},t.prototype.loadForm=function(){return _(this,void 0,void 0,function(){return S(this,function(e){return[2,(0,wp.apiFetch)({url:w+"/"+this.props.form+".json"})]})})},t}(f.a.Component),C=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),E=wp.i18n.__,O=function(e){function t(t){var n=e.call(this,t)||this;return n.state={formValid:!1},n}return C(t,e),t.prototype.render=function(){var e=this;return this.props.open?f.a.createElement(wp.components.Modal,{shouldCloseOnClickOutside:!1,style:{minWidth:"60%"},title:this.props.title,onRequestClose:function(){e.props.onClose()}},this.renderContent()):null},t.prototype.renderContent=function(){var e=this;return this.props.values?this.props.saveError?f.a.createElement(wp.components.Notice,{status:"error",isDismissible:!1},f.a.createElement("p",null,"An error occurred: ",f.a.createElement("code",null,this.props.saveError),".")):this.props.saving?f.a.createElement(wp.components.Placeholder,{style:{height:"300px"}},f.a.createElement(wp.components.Spinner,null)):f.a.createElement("div",{style:{position:"relative"}},this.props.locales?f.a.createElement("div",{style:{whiteSpace:"nowrap",position:"absolute",top:"0px",paddingTop:"10px",paddingBottom:"5px",width:"150px",right:"0px",height:"25px",background:"#fff",textAlign:"right",zIndex:1}},this.renderLocales()):null,f.a.createElement(T,{title:this.props.title,form:this.props.form,values:this.props.values,valid:this.state.formValid,onValidityChage:function(t){e.onValidityChage(t)},onValuesChange:function(t){e.onValuesChange(t)},afterFormRender:this.props.afterFormRender}),f.a.createElement("div",{style:{position:"absolute",bottom:"0px",left:"0px",right:"0px",height:"25px",paddingTop:"5px",background:"#fff",zIndex:1}},f.a.createElement("button",{disabled:!this.state.formValid,onClick:function(){e.props.onSave()}}," ",this.props.saveButtonText," "),f.a.createElement("button",{style:{marginLeft:"3px"},onClick:function(){e.props.onClose()}}," ",E("Cancel","kunta_api_core")," "))):f.a.createElement(wp.components.Placeholder,{style:{height:"300px"}},f.a.createElement(wp.components.Spinner,null))},t.prototype.renderLocales=function(){var e=this;return this.props.locales.map(function(t){return f.a.createElement("button",{style:{marginLeft:"3px"},onClick:function(){e.props.onLocaleChange(t)}}," ",t," ")})},t.prototype.onValidityChage=function(e){this.setState({formValid:e})},t.prototype.onValuesChange=function(e){this.props.onValuesChange&&this.props.onValuesChange(this.props.locale,e)},t}(f.a.Component),L=function(){function e(){}return e.prototype.getSupportedLocales=function(){return["fi","sv","en"]},e.prototype.getLocalizedValue=function(e,t,n){return i.getLocalizedValue(e,t,n)},e.prototype.getLocalizedValues=function(e,t){return(e||[]).filter(function(e){return e.value&&e.language===t})},e.prototype.setLocalizedValue=function(e,t,n,r,a){this.setLocalizedPropertyValue(e,t,"value",n,r,a)},e.prototype.setTypedLocalizedValue=function(e,t,n,r,a,o){e[t]||(e[t]=[]);var i=n[r];if(i){for(var s=0;s<e[t].length;s++)if(e[t][s].language===a&&e[t][s].type===o)return void(e[t][s].value=i);e[t].push({value:i,language:a,type:o})}},e.prototype.setLocalizedTableValues=function(e,t,n,r,a,o,i){e[t]||(e[t]=[]);var s=n[r];if(s){var c=Array.isArray(s)?s:JSON.parse(s);o&&(c=c.filter(o));var u=c.map(i||function(e){return Object.assign({language:a},e)})||[];e[t]=e[t].concat(u)}},e.prototype.getTypedLocalizedValue=function(e,t,n){if(!e)return null;for(var r=0;r<e.length;r++)if(t===e[r].language&&n===e[r].type)return e[r].value;return null},e.prototype.getAreaIds=function(e){var t=[];return e.forEach(function(e){"Municipality"!==e.type?t.push(e.type+":"+e.code):e.municipalities.forEach(function(e){t.push("Municipality:"+e.code)})}),t},e.prototype.areasFromForm=function(e,t){if("LimitedType"===e){var n=-1,r=[];return(t||"").split(",").forEach(function(e){var t=e.split(":"),a=t[0],o=t[1];"Municipality"===a?n>-1?r[n].municipalities.push({code:o}):n=r.push({type:"Municipality",municipalities:[{code:o}]})-1:r.push({type:a,code:o})}),r}},e.prototype.getFormBooleanValue=function(e,t){return"true"===e||"false"!==e&&t},e.prototype.getLocalizedEmails=function(e,t){return this.getLocalizedValues(e,t)},e.prototype.getLocalizedPhoneNumbers=function(e,t,n){return(e||[]).filter(function(e){return(!n||e.type===n)&&(e.number&&e.language===t)}).map(function(e){return Object.assign({},e,{isFinnishServiceNumber:e.isFinnishServiceNumber?"true":"false"})})},e.prototype.getLocalizedWebPageUrl=function(e,t){var n=this.getLocalizedWebPages(e,t);return n&&n.length?n[0].url:null},e.prototype.getLocalizedWebPages=function(e,t){return(e||[]).filter(function(e){return e.url&&e.language===t})},e.prototype.setLocalizedWebPages=function(e,t,n,r,a){this.setLocalizedPropertyValue(e,t,"url",n,r,a)},e.prototype.setLocalizedPropertyValue=function(e,t,n,r,a,o){e[t]||(e[t]=[]);var i=r[a];if(i){for(var s=0;s<e[t].length;s++)if(e[t][s].language===o)return void(e[t][s].value=i);var c={language:o};c[n]=i,e[t].push(c)}},e.prototype.getFormArray=function(e,t){return!e||e[t]?[]:Array.isArray(e[t])?e[t]:JSON.parse(e[t])},e}(),P=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),k=function(e){function t(){return e.call(this)||this}return P(t,e),t.prototype.applyToService=function(e,t,n,r){var a=this,o=JSON.parse(JSON.stringify(r));o.names=[],o.descriptions=[],o.vouchers=[],o.legislation=[],this.getSupportedLocales().forEach(function(t){var n=e[t],r=Array.isArray(n.legislation)?n.legislation:n.legislation?JSON.parse(n.legislation):[];o.type=n.type||o.type,o.chargeType=n.serviceChargeType||o.chargeType,o.fundingType=n.fundingType||o.fundingType,a.setTypedLocalizedValue(o,"names",n,"name",t,"Name"),a.setTypedLocalizedValue(o,"names",n,"alternateName",t,"AlternativeName"),a.setTypedLocalizedValue(o,"descriptions",n,"shortDescription",t,"Summary"),a.setTypedLocalizedValue(o,"descriptions",n,"description",t,"Description"),a.setTypedLocalizedValue(o,"descriptions",n,"chargeTypeAdditionalInfo",t,"ChargeTypeAdditionalInfo"),a.setTypedLocalizedValue(o,"descriptions",n,"userInstruction",t,"UserInstruction"),a.setTypedLocalizedValue(o,"descriptions",n,"deadLineAdditionalInfo",t,"DeadLine"),a.setTypedLocalizedValue(o,"descriptions",n,"processingTimeAdditionalInfo",t,"ProcessingTime"),a.setTypedLocalizedValue(o,"descriptions",n,"validityTimeAdditionalInfo",t,"ValidityTime"),a.setLocalizedValue(o,"requirements",n,"requirements",t),a.setLocalizedTableValues(o,"vouchers",n,"serviceVouchers",t,function(e){return e.value&&e.url}),o.legislation=o.legislation.concat(r.filter(function(e){return e.name&&e.webPage}).map(function(e){return{names:[{language:t,value:e.name}],webPages:[{url:e.webPage,type:"url",language:t}]}}))}),o.areaType=t.areaType,o.languages=(t.languages||"").split(","),o.areas=this.areasFromForm(t.areaType,t.areas),o.organizations=o.organizations.filter(function(e){return"Responsible"===e.roleType});var i=o.organizations.filter(function(e){return"Responsible"===e.roleType&&e.organizationId}).map(function(e){return e.organizationId})[0];i&&t.serviceProducersSelfProduced&&o.organizations.push({provisionType:"SelfProducedServices",roleType:"Producer",organizationId:i});var s=(t.serviceProducersPurchaseServices||"").split(","),c=(t.serviceProducersOthers||"").split(",");return s.forEach(function(e){o.organizations.push({provisionType:"ProcuredServices",roleType:"Producer",organizationId:e})}),c.forEach(function(e){o.organizations.push({provisionType:"Other",roleType:"Producer",organizationId:e})}),o.electronicServiceChannelIds=n.electronic,o.phoneServiceChannelIds=n.phone,o.printableFormServiceChannelIds=n.printableForm,o.serviceLocationServiceChannelIds=n.serviceLocation,o.webPageServiceChannelIds=n.webpage,o},t.prototype.serviceToForm=function(e,t){var n=this,r=t.type,a=t.chargeType,o=t.fundingType,i=this.getTypedLocalizedValue(t.names,e,"Name"),s=this.getTypedLocalizedValue(t.names,e,"AlternateName"),c=this.getTypedLocalizedValue(t.descriptions,e,"Summary"),u=this.getTypedLocalizedValue(t.descriptions,e,"Description"),l=this.getTypedLocalizedValue(t.descriptions,e,"ChargeTypeAdditionalInfo"),p=this.getTypedLocalizedValue(t.descriptions,e,"UserInstruction"),h=this.getTypedLocalizedValue(t.descriptions,e,"DeadLine"),d=this.getTypedLocalizedValue(t.descriptions,e,"ProcessingTime"),f=this.getTypedLocalizedValue(t.descriptions,e,"ValidityTime"),v=this.getLocalizedValue(t.requirements,e),m=(t.vouchers||[]).filter(function(t){return t.value&&t.language===e}),y=(t.legislation||[]).map(function(t){return{name:n.getLocalizedValue(t.names,e),webPage:n.getLocalizedValue(t.webPages,e,"url")}}).filter(function(e){return e.name&&e.webPage});return{type:r,serviceChargeType:a,fundingType:o,name:i,alternateName:s,shortDescription:c,description:u,chargeTypeAdditionalInfo:l,userInstruction:p,deadLineAdditionalInfo:h,processingTimeAdditionalInfo:d,validityTimeAdditionalInfo:f,requirements:v,serviceVouchersInUse:m.length>0?"true":"false",serviceVouchers:m,legislation:y}},t.prototype.serviceAdditinalToForm=function(e){return{languages:(e.languages||[]).join(","),areas:this.getAreaIds(e.areas||[]).join(","),areaType:e.areaType,serviceProducersSelfProduced:(e.organizations||[]).filter(function(e){return"Producer"===e.roleType&&"SelfProducedServices"===e.provisionType}).length>0,serviceProducersPurchaseServices:this.getServiceProducerOrganizationIds(e,"ProcuredServices").join(","),serviceProducersOthers:this.getServiceProducerOrganizationIds(e,"Other").join(",")}},t.prototype.getServiceProducerOrganizationIds=function(e,t){return(e.organizations||[]).filter(function(e){return e.organizationId&&"Producer"===e.roleType&&e.provisionType===t}).map(function(e){return e.organizationId})},t}(L),A=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),I=function(e,t,n,r){return new(n||(n=Promise))(function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})},V=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},z=wp.data.withSelect,F=wp.i18n.__,x=function(e){function t(t){var n=e.call(this,t)||this;return n.state={values:t.values},n}return A(t,e),t.prototype.render=function(){var e=this;return this.props.open?f.a.createElement(O,{onValuesChange:function(t,n){e.updateValues(n)},form:"service/additionaldetails",values:this.getValues(),title:F("Service details","kunta_api_core"),saveButtonText:F("Apply","kunta_api_core"),open:this.props.open,onSave:function(){e.props.applyValues(e.state.values)},onClose:function(){e.props.onClose()},afterFormRender:function(t,n){e.afterFormRender(t,n)}}):null},t.prototype.afterFormRender=function(e,t){return I(this,void 0,void 0,function(){return V(this,function(n){return this.createLanguagesAutocomplete(t.find('*[data-name="languages"]'),(this.state.values.languages||"").split(",")),this.createAreasAutocomplete(t.find('*[data-name="areas"]'),(this.state.values.areas||"").split(",")),this.createServiceProducersAutocomplete(e,t.find('*[data-name="serviceProducersPurchaseServices"]'),(this.state.values.serviceProducersPurchaseServices||"").split(",").filter(function(e){return!!e})),this.createServiceProducersAutocomplete(e,t.find('*[data-name="serviceProducersOthers"]'),(this.state.values.serviceProducersOthers||"").split(",").filter(function(e){return!!e})),[2]})})},t.prototype.createAreasAutocomplete=function(e,t){return I(this,void 0,void 0,function(){var n,r;return V(this,function(a){switch(a.label){case 0:return e.val(""),[4,i.loadAreas(t)];case 1:return n=a.sent(),r=n.map(function(e){var t=e.type+":"+e.code;return"Municipality"==e.type?{value:t,label:i.getMunicipalityNameWithType(e)}:{value:t,label:i.getCodeNameWithType(e)}}),e.autocomplete("option","open",function(){jQuery(".ui-autocomplete").css("z-index",999999)}).metaformMultivalueAutocomplete("val",r,!1).metaformMultivalueAutocomplete("option","customSource",function(e,t){i.searchCodes("Municipality,Province,HospitalRegions,BusinessRegions",e.term+"*").then(function(e){t(e.map(function(e){return{value:e.type+":"+e.code,label:i.getCodeNameWithType(e)}}))}).catch(function(e){alert(e)})}),[2]}})})},t.prototype.createLanguagesAutocomplete=function(e,t){return I(this,void 0,void 0,function(){var n;return V(this,function(r){switch(r.label){case 0:return e.val(""),[4,i.loadLanguageCodes(t)];case 1:return n=r.sent(),e.autocomplete("option","open",function(){jQuery(".ui-autocomplete").css("z-index",999999)}).metaformMultivalueAutocomplete("val",n,!1).metaformMultivalueAutocomplete("option","customSource",function(e,t){i.searchCodes("Language",e.term+"*").then(function(e){t(e.map(function(e){return{value:e.code,label:i.getLocalizedValue(e.names,"fi")}}))}).catch(function(e){alert(e)})}),[2]}})})},t.prototype.createServiceProducersAutocomplete=function(e,t,n){return I(this,void 0,void 0,function(){var r,a=this;return V(this,function(o){switch(o.label){case 0:return t.val(""),[4,Promise.all(n.map(function(e){return I(a,void 0,void 0,function(){var t;return V(this,function(n){switch(n.label){case 0:return[4,i.findOrganization(e)];case 1:return[2,{value:(t=n.sent()).id,label:i.getLocalizedValue(t.names,"fi")}]}})})}))];case 1:return r=o.sent(),t.autocomplete("option","open",function(){jQuery(".ui-autocomplete").css("z-index",999999)}).metaformMultivalueAutocomplete("val",r,!1).metaformMultivalueAutocomplete("option","onchange",function(){e.triggerChange()}).metaformMultivalueAutocomplete("option","customSource",function(e,t){var n=i.splitSearchTerms(e.term);n?i.searchOrganizations(n).then(function(e){t(e.map(function(e){return{value:e.id,label:i.getLocalizedValue(e.names,"fi")}}))}).catch(function(e){alert(e)}):t([])}),[2]}})})},t.prototype.updateValues=function(e){this.setState({values:e})},t.prototype.getValues=function(){return this.state.values},t}(f.a.Component),N=z(function(e,t){var n=e("kunta-api/data").getService,r=t.serviceId;return{service:r?n(r):{}}})(x),j=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),q=function(e){function t(){return e.call(this)||this}return j(t,e),t.prototype.serviceHoursToForm=function(e){var t=this;return e.serviceHours.map(function(e){return t.serviceHourToForm(e)})},t.prototype.serviceHoursFromForm=function(e){var t=this;return e.map(function(e){return t.serviceHourFromForm(e)})},t.prototype.serviceHourFromForm=function(e){switch(e.type){case"Exceptional":return this.serviceHourFromFormException(e);case"DaysOfTheWeek":return this.serviceHourFromFormStandard(e);case"OverMidnight":return this.serviceHourFromFormSpecial(e)}},t.prototype.serviceHourFromFormException=function(e){var t=[],n="closed-all-day"===e.type,r=n?null:e["Exception-to-time"],a=n?null:e["Exception-from-time"],o=[];return(r||a)&&o.push({dayFrom:null,dayTo:null,from:a,to:r,isExtra:!1}),this.getSupportedLocales().forEach(function(n){var r=e["Exception-additional-information-"+n];r&&t.push({language:n,value:r})}),{serviceHourType:e.type,validFrom:i.parseIsoDate(e["Exception-from-date"]),validTo:i.parseIsoDate(e["Exception-to-date"]),isClosed:n,validForNow:!1,additionalInformation:t,openingHour:o}},t.prototype.serviceHourFromFormStandard=function(e){var t="true"===e[e.type+"-validForNow"],n=e["Standard-open24h"]?[]:e["Standard-openinghours"]||[],r=(Array.isArray(n)?n:JSON.parse(n)).map(function(e){return{dayFrom:parseInt(e.day),dayTo:parseInt(e.day),from:e.from,to:e.to,isExtra:!1}});return{serviceHourType:e.type,validFrom:t?null:i.parseIsoDate(e[e.type+"-validFrom"]),validTo:t?null:i.parseIsoDate(e[e.type+"-validTo"]),isClosed:!1,validForNow:t,additionalInformation:[],openingHour:r}},t.prototype.serviceHourFromFormSpecial=function(e){var t="true"===e[e.type+"-validForNow"],n=[{dayFrom:parseInt(e["Special-from-date"]),dayTo:parseInt(e["Special-to-date"]),from:e["Special-from-time"],to:e["Special-to-time"],isExtra:!1}];return{serviceHourType:e.type,validFrom:t?null:i.parseIsoDate(e[e.type+"-validFrom"]),validTo:t?null:i.parseIsoDate(e[e.type+"-validTo"]),isClosed:!1,validForNow:t,additionalInformation:[],openingHour:n}},t.prototype.serviceHourToForm=function(e){var t=this;if(!e)return{};var n=e.serviceHourType,r=e.validForNow?"true":"false",a=e.validForNow||!e.validFrom?null:moment(e.validFrom),o=e.validForNow||!e.validTo?null:moment(e.validTo),i=0===e.openingHour.length&&!e.isClosed,s=a?a.format():null,c=o?o.format():null,u=e.openingHour&&e.openingHour.length?e.openingHour[0]:null,l=[];switch((e.openingHour||[]).forEach(function(e){for(var t=e.dayFrom;t<=e.dayTo;t++)l.push({day:t,from:e.from,to:e.to})}),n){case"DaysOfTheWeek":return{type:n,"Standard-validForNow":r,"Standard-validFrom":s,"Standard-validTo":c,"Standard-open24h":i,"Standard-openinghours":l};case"OverMidnight":return{type:n,"Special-validForNow":r,"Special-validFrom":s,"Special-validTo":c,"Special-from-date":u?u.dayFrom:null,"Special-from-time":u?u.from:null,"Special-to-date":u?u.dayTo:null,"Special-to-time":u?u.to:null};case"Exceptional":var p=u?u.from:null,h=u?u.to:null,d=o?"range":p||h?"single":"closed-all-day";if(a&&p){var f=p.split(":");a.hour(parseInt(f[0])),a.minute(parseInt(f[1]))}if(o&&h){f=h.split(":");o.hour(parseInt(f[0])),o.minute(parseInt(f[1]))}var v={type:n,"Exception-type":d,"Exception-from-date":a?a.format():null,"Exception-to-date":o?o.format():null,"Exception-from-time":p,"Exception-to-time":h};return this.getSupportedLocales().forEach(function(n){v["Exception-additional-information-"+n]=t.getLocalizedValue(e.additionalInformation,n)}),v;default:throw new Error("Unknown service hour type "+n)}},t}(L),H=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),D=function(e){function t(){return e.call(this)||this}return H(t,e),t.prototype.channelToForm=function(e,t){return{name:this.getTypedLocalizedValue(t.names,e,"Name"),shortDescription:this.getTypedLocalizedValue(t.descriptions,e,"Summary"),description:this.getTypedLocalizedValue(t.descriptions,e,"Description"),supportPhones:this.getLocalizedPhoneNumbers(t.supportPhones,e),supportEmails:this.getLocalizedEmails(t.supportEmails,e),languages:t.languages,attachments:(t.attachments||[]).filter(function(t){return t.url&&t.language===e}),webPage:this.getLocalizedWebPageUrl(t.webPages,e),serviceHours:null,publishingStatus:t.publishingStatus}},t.prototype.additionalToForm=function(e){return{requiresAuthentication:e.requiresAuthentication,requiresSignature:e.requiresSignature,signatureQuantity:e.signatureQuantity,areas:this.getAreaIds(e.areas||[]).join(","),areaType:e.areaType}},t.prototype.applyToChannel=function(e,t,n,r){var a=this,o=JSON.parse(JSON.stringify(r));return o.names=[],o.descriptions=[],o.webPages=[],o.attachments=[],o.requiresSignature=!1,o.requiresAuthentication=!1,o.supportPhones=[],o.supportEmails=[],o.attachments=[],o.serviceHours=this.serviceHoursFromForm(n),this.getSupportedLocales().forEach(function(t){var n=e[t];o.publishingStatus=n.publishingStatus||o.publishingStatus,a.setTypedLocalizedValue(o,"names",n,"name",t,"Name"),a.setTypedLocalizedValue(o,"descriptions",n,"shortDescription",t,"Summary"),a.setTypedLocalizedValue(o,"descriptions",n,"description",t,"Description"),a.setLocalizedTableValues(o,"supportPhones",n,"supportPhones",t,function(e){return!!e.number},function(e){return Object.assign({},e,{language:t,isFinnishServiceNumber:"true"===e.isFinnishServiceNumber,type:"Phone"})}),a.setLocalizedTableValues(o,"supportEmails",n,"supportEmails",t,function(e){return!!e.value}),a.setLocalizedWebPages(o,"webPages",n,"webPage",t),a.setLocalizedTableValues(o,"attachments",n,"attachments",t,function(e){return!!e.url},function(e){return Object.assign(e,{language:t,type:"Attachment"})})}),o.areaType=t.areaType,o.areas=this.areasFromForm(t.areaType,t.areas),o.requiresAuthentication=this.getFormBooleanValue(t.requiresAuthentication,o.requiresAuthentication),o.requiresSignature=this.getFormBooleanValue(t.requiresSignature,o.requiresSignature),o.signatureQuantity=o.requiresSignature?t.signatureQuantity||o.signatureQuantity:1,o},t}(q),R=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),M=function(e,t,n,r){return new(n||(n=Promise))(function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})},B=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},W=wp.data.withSelect,J=wp.i18n.__,U=function(e){function t(t){var n=e.call(this,t)||this;return n.state={values:t.values},n}return R(t,e),t.prototype.render=function(){var e=this;return this.props.open?f.a.createElement(O,{onValuesChange:function(t,n){e.updateValues(n)},form:"servicechannel/"+this.getForm(),values:this.getValues(),title:J("Channel details","kunta_api_core"),saveButtonText:J("Apply","kunta_api_core"),open:this.props.open,onSave:function(){e.props.applyValues(e.state.values)},onClose:function(){e.props.onClose()},afterFormRender:function(t,n){e.afterFormRender(t,n)}}):null},t.prototype.getForm=function(){switch(this.props.channelType){case"electronic":return"electronic-additionaldetails";case"phone":return"phone-additionaldetails";case"printableForm":return"printable-form-additionaldetails";case"webpage":return"webpage-additionaldetails";case"serviceLocation":return"service-location-additionaldetails"}return this.props.channelType},t.prototype.afterFormRender=function(e,t){return M(this,void 0,void 0,function(){return B(this,function(e){return this.createAreasAutocomplete(t.find('*[data-name="areas"]'),(this.state.values.areas||"").split(",")),this.createLanguagesAutocomplete(t.find('*[data-name="languages"]'),(this.state.values.languages||"").split(",")),[2]})})},t.prototype.createAreasAutocomplete=function(e,t){return M(this,void 0,void 0,function(){var n,r;return B(this,function(a){switch(a.label){case 0:return e.val(""),[4,i.loadAreas(t)];case 1:return n=a.sent(),r=n.map(function(e){var t=e.type+":"+e.code;return"Municipality"==e.type?{value:t,label:i.getMunicipalityNameWithType(e)}:{value:t,label:i.getCodeNameWithType(e)}}),e.autocomplete("option","open",function(){jQuery(".ui-autocomplete").css("z-index",999999)}).metaformMultivalueAutocomplete("val",r,!1).metaformMultivalueAutocomplete("option","customSource",function(e,t){i.searchCodes("Municipality,Province,HospitalRegions,BusinessRegions",e.term+"*").then(function(e){t(e.map(function(e){return{value:e.type+":"+e.code,label:i.getCodeNameWithType(e)}}))}).catch(function(e){alert(e)})}),[2]}})})},t.prototype.createLanguagesAutocomplete=function(e,t){return M(this,void 0,void 0,function(){var n;return B(this,function(r){switch(r.label){case 0:return e.val(""),[4,i.loadLanguageCodes(t)];case 1:return n=r.sent(),e.autocomplete("option","open",function(){jQuery(".ui-autocomplete").css("z-index",999999)}).metaformMultivalueAutocomplete("val",n,!1).metaformMultivalueAutocomplete("option","customSource",function(e,t){i.searchCodes("Language",e.term+"*").then(function(e){t(e.map(function(e){return{value:e.code,label:i.getLocalizedValue(e.names,"fi")}}))}).catch(function(e){alert(e)})}),[2]}})})},t.prototype.updateValues=function(e){this.setState({values:e})},t.prototype.getValues=function(){return this.state.values},t}(f.a.Component),Q=W(function(e,t){var n=e("kunta-api/data").getServiceChannel,r=t.channelType,a=t.channelId;return{channel:(a?n(r,a):null)||{}}})(U),G=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$=function(e,t,n,r){return new(n||(n=Promise))(function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})},Y=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},K=wp.i18n.__,X=function(e){function t(t){var n=e.call(this,t)||this;return n.state={values:t.values},n}return G(t,e),t.prototype.render=function(){var e=this;return f.a.createElement(O,{form:"general/servicehour",values:this.state.values,title:K("Service hour","kunta_api_core"),saveButtonText:this.props.okButtonText,open:!0,onValuesChange:function(t,n){e.setState({values:n})},onSave:function(){e.props.onOkClick(e.state.values)},onClose:function(){e.props.onClose()},afterFormRender:function(t,n){e.afterFormRender(t,n)}})},t.prototype.afterFormRender=function(e,t){return $(this,void 0,void 0,function(){return Y(this,function(e){return[2]})})},t}(f.a.Component),Z=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ee=function(e){function t(){return e.call(this)||this}return Z(t,e),t.prototype.channelToForm=function(e,t){return{name:this.getTypedLocalizedValue(t.names,e,"Name"),shortDescription:this.getTypedLocalizedValue(t.descriptions,e,"Summary"),description:this.getTypedLocalizedValue(t.descriptions,e,"Description"),phoneNumbers:this.getLocalizedPhoneNumbers(t.phoneNumbers,e),supportEmails:this.getLocalizedEmails(t.supportEmails,e),languages:t.languages,webPages:this.getLocalizedValue(t.webPages,e,"url"),serviceHours:null,publishingStatus:t.publishingStatus}},t.prototype.additionalToForm=function(e){return{languages:e.languages.join(","),areas:this.getAreaIds(e.areas||[]).join(","),areaType:e.areaType}},t.prototype.applyToChannel=function(e,t,n,r){var a=this,o=JSON.parse(JSON.stringify(r));return o.names=[],o.descriptions=[],o.phoneNumbers=[],o.supportEmails=[],o.webPages=[],o.serviceHours=this.serviceHoursFromForm(n),this.getSupportedLocales().forEach(function(t){var n=e[t];o.publishingStatus=n.publishingStatus||o.publishingStatus,a.setTypedLocalizedValue(o,"names",n,"name",t,"Name"),a.setTypedLocalizedValue(o,"descriptions",n,"shortDescription",t,"Summary"),a.setTypedLocalizedValue(o,"descriptions",n,"description",t,"Description"),a.setLocalizedTableValues(o,"phoneNumbers",n,"phoneNumbers",t,function(e){return!!e.number},function(e){return Object.assign({},e,{language:t,isFinnishServiceNumber:"true"===e.isFinnishServiceNumber})}),a.setLocalizedTableValues(o,"supportEmails",n,"supportEmails",t,function(e){return!!e.value}),n.webPages&&o.webPages.push({url:n.webPages,language:t})}),o.areaType=t.areaType,o.areas=this.areasFromForm(t.areaType,t.areas),o.languages=t.languages.split(","),o},t}(q),te=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ne=function(e){function t(){return e.call(this)||this}return te(t,e),t.prototype.channelToForm=function(e,t){var n=t.deliveryAddress||{};return{name:this.getTypedLocalizedValue(t.names,e,"Name"),shortDescription:this.getTypedLocalizedValue(t.descriptions,e,"Summary"),description:this.getTypedLocalizedValue(t.descriptions,e,"Description"),formIdentifier:this.getLocalizedValue(t.formIdentifier,e),formReceiver:this.getLocalizedValue(t.formReceiver,e),addressType:n.subtype,streetAddress:this.getLocalizedValue(n.streetAddress,e),postOfficeBox:this.getLocalizedValue(n.postOfficeBox,e),streetNumber:n.streetNumber,postalCode:n.postalCode,addressAdditionalInformation:this.getLocalizedValue(n.additionalInformations,e),addressAdditionalInformationNoAddress:this.getLocalizedValue(n.additionalInformations,e),channelUrls:this.getLocalizedValues(t.channelUrls,e),attachments:(t.attachments||[]).filter(function(t){return t.url&&t.language===e}),supportPhones:this.getLocalizedPhoneNumbers(t.supportPhones,e),supportEmails:this.getLocalizedEmails(t.supportEmails,e),publishingStatus:t.publishingStatus}},t.prototype.additionalToForm=function(e){return{areas:this.getAreaIds(e.areas||[]).join(","),areaType:e.areaType}},t.prototype.applyToChannel=function(e,t,n,r){var a=this,o=JSON.parse(JSON.stringify(r));return o.names=[],o.descriptions=[],o.formIdentifier=[],o.formReceiver=[],o.channelUrls=[],o.deliveryAddress={},o.supportPhones=[],o.attachments=[],o.serviceHours=this.serviceHoursFromForm(n),this.getSupportedLocales().forEach(function(t){var n=e[t];o.publishingStatus=n.publishingStatus||o.publishingStatus,a.setTypedLocalizedValue(o,"names",n,"name",t,"Name"),a.setTypedLocalizedValue(o,"descriptions",n,"shortDescription",t,"Summary"),a.setTypedLocalizedValue(o,"descriptions",n,"description",t,"Description"),a.setLocalizedValue(o,"formIdentifier",n,"formIdentifier",t),a.setLocalizedValue(o,"formReceiver",n,"formReceiver",t),a.setLocalizedTableValues(o,"supportPhones",n,"supportPhones",t,function(e){return!!e.number},function(e){return Object.assign({},e,{language:t,isFinnishServiceNumber:"true"===e.isFinnishServiceNumber,type:"Phone"})}),a.setLocalizedTableValues(o,"supportEmails",n,"supportEmails",t,function(e){return!!e.value}),a.setLocalizedTableValues(o,"attachments",n,"attachments",t,function(e){return!!e.url},function(e){return Object.assign(e,{language:t,type:"Attachment"})}),n.webPages&&o.webPages.push({url:n.webPages,language:t}),a.setLocalizedTableValues(o,"channelUrls",n,"channelUrls",t,function(e){return!!e.value},function(e){return Object.assign(e,{language:t})});var r=n.addressType;o.deliveryAddress.subtype||(o.deliveryAddress.subtype=r,o.deliveryAddress.streetNumber=n.streetNumber||o.deliveryAddress.streetNumber,o.deliveryAddress.postalCode=n.postalCode||o.deliveryAddress.postalCode),a.setLocalizedValue(o.deliveryAddress,"streetAddress",n,"streetAddress",t),a.setLocalizedValue(o.deliveryAddress,"postOfficeBox",n,"postOfficeBox",t),a.setLocalizedValue(o.deliveryAddress,"additionalInformations",n,"NoAddress"===r?"addressAdditionalInformationNoAddress":"addressAdditionalInformation",t)}),o.areaType=t.areaType,o.areas=this.areasFromForm(t.areaType,t.areas),o},t}(q),re=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ae=function(e){function t(){return e.call(this)||this}return re(t,e),t.prototype.channelToForm=function(e,t){return{name:this.getTypedLocalizedValue(t.names,e,"Name"),shortDescription:this.getTypedLocalizedValue(t.descriptions,e,"Summary"),description:this.getTypedLocalizedValue(t.descriptions,e,"Description"),supportPhones:this.getLocalizedPhoneNumbers(t.supportPhones,e),supportEmails:this.getLocalizedEmails(t.supportEmails,e),webPage:this.getLocalizedWebPageUrl(t.webPages,e),languages:t.languages,publishingStatus:t.publishingStatus}},t.prototype.additionalToForm=function(e){return{languages:e.languages.join(",")}},t.prototype.applyToChannel=function(e,t,n,r){var a=this,o=JSON.parse(JSON.stringify(r));return o.names=[],o.descriptions=[],o.webPages=[],o.supportPhones=[],o.supportEmails=[],this.getSupportedLocales().forEach(function(t){var n=e[t];o.publishingStatus=n.publishingStatus||o.publishingStatus,a.setTypedLocalizedValue(o,"names",n,"name",t,"Name"),a.setTypedLocalizedValue(o,"descriptions",n,"shortDescription",t,"Summary"),a.setTypedLocalizedValue(o,"descriptions",n,"description",t,"Description"),a.setLocalizedTableValues(o,"supportPhones",n,"supportPhones",t,function(e){return!!e.number},function(e){return Object.assign({},e,{language:t,isFinnishServiceNumber:"true"===e.isFinnishServiceNumber,type:"Phone"})}),a.setLocalizedTableValues(o,"supportEmails",n,"supportEmails",t,function(e){return!!e.value}),a.setLocalizedWebPages(o,"webPages",n,"webPage",t)}),o.languages=t.languages.split(","),o},t}(q),oe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ie=function(e){function t(){return e.call(this)||this}return oe(t,e),t.prototype.channelToForm=function(e,t){var n=this,r=this.getTypedLocalizedValue(t.names,e,"Name"),a=this.getTypedLocalizedValue(t.descriptions,e,"Summary"),o=this.getTypedLocalizedValue(t.descriptions,e,"Description"),i=t.addresses.filter(function(e){return"Abroad"!==e.subtype}),s=t.addresses.filter(function(e){return"Abroad"===e.subtype});return{name:r,description:o,shortDescription:a,addresses:i.map(function(t){return{street:n.getLocalizedValue(t.streetAddress,e),streetNumber:t.streetNumber,postOfficeCode:t.postalCode,additionalInformation:n.getLocalizedValue(t.additionalInformations,e)}}),emails:this.getLocalizedEmails(t.emails,e),phoneNumbers:this.getLocalizedPhoneNumbers(t.phoneNumbers,e,"Phone"),faxes:this.getLocalizedPhoneNumbers(t.phoneNumbers,e,"Fax"),foreignAddresses:s.map(function(t){return{foreign:n.getLocalizedValue(t.locationAbroad,e)}}),webPages:this.getLocalizedWebPages(t.webPages,e)}},t.prototype.additionalToForm=function(e){return{languages:e.languages.join(","),areas:this.getAreaIds(e.areas||[]).join(","),areaType:e.areaType}},t.prototype.applyToChannel=function(e,t,n,r){var a=this,o=JSON.parse(JSON.stringify(r));return o.addresses=[],o.descriptions=[],o.emails=[],o.phoneNumbers=[],o.webPages=[],o.serviceHours=this.serviceHoursFromForm(n),this.getSupportedLocales().forEach(function(t){var n=e[t];a.setTypedLocalizedValue(o,"names",n,"name",t,"Name"),a.setTypedLocalizedValue(o,"descriptions",n,"shortDescription",t,"Summary"),a.setTypedLocalizedValue(o,"descriptions",n,"description",t,"Description");var r=a.getFormArray(n,"addresses").filter(function(e){return!!e.street&&!!e.street.trim()});r.forEach(function(e,n){var r;o.addresses.length-1<n?(r={additionalInformations:[],streetAddress:[],subtype:"Single",type:"Location",country:"FI"},o.addresses.push(r)):r=o.addresses[n],e.additionalInformation&&(e.additionalInformation=e.additionalInformation.trim()),e.additionalInformation&&r.additionalInformations.push({language:t,value:e.additionalInformation}),r.streetAddress.push({language:t,value:e.street}),r.postalCode=e.postOfficeCode,r.streetNumber=e.streetNumber}),a.getFormArray(n,"foreignAddresses").filter(function(e){return!!e.foreign}).forEach(function(e,n){var a,i=r.length+n;o.addresses.length-1<i?(a={subtype:"Abroad",type:"Location",locationAbroad:[]},o.addresses.push(a)):a=o.addresses[i],a.locationAbroad.push({language:t,value:e.foreign})}),a.setLocalizedTableValues(o,"emails",n,"emails",t,function(e){return!!e.value}),a.setLocalizedTableValues(o,"phoneNumbers",n,"phoneNumbers",t,function(e){return e.prefixNumber||e.number},function(e){return Object.assign(e,{type:"Phone",language:t,isFinnishServiceNumber:"true"===e.isFinnishServiceNumber})}),a.setLocalizedTableValues(o,"phoneNumbers",n,"faxes",t,function(e){return e.prefixNumber||e.number},function(e){return Object.assign(e,{type:"Fax",language:t,number:e.number,prefixNumber:e.prefixNumber,isFinnishServiceNumber:!1})}),o.webPages=o.webPages.concat(a.getFormArray(n,"webPages").filter(function(e){return!!e.url}).map(function(e){return Object.assign(e,{language:t})}))}),o.areaType=t.areaType,o.areas=this.areasFromForm(t.areaType,t.areas),o.languages=t.languages.split(","),o},t}(q),se=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ce=function(){return(ce=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ue=wp.data.withSelect,le=wp.i18n,pe=le.__,he=le.sprintf,de=["fi","sv","en"],fe=function(e){function t(t){var n=e.call(this,t)||this,r=n.getAdapter(),a={};return t.channel&&de.forEach(function(e){a[e]=r.channelToForm(e,t.channel)}),n.state={locale:"fi",saving:!1,saveError:null,additionalDetailsOpen:!1,values:a,additionalValues:t.channel?r.additionalToForm(t.channel):{},editServiceHourOpen:!1,serviceHours:t.channel?r.serviceHoursToForm(t.channel):[],editServiceHourIndex:-1},n}return se(t,e),t.prototype.componentDidUpdate=function(e,t){var n=this;if(JSON.stringify(this.props.channel)!==JSON.stringify(e.channel)){var r=this.getAdapter(),a={};this.props.channel&&de.forEach(function(e){a[e]=n.getAdapter().channelToForm(e,n.props.channel)}),this.setState({values:a,additionalValues:this.props.channel?r.additionalToForm(this.props.channel):{},serviceHours:this.props.channel?r.serviceHoursToForm(this.props.channel):[]})}JSON.stringify(this.state.serviceHours)!==JSON.stringify(t.serviceHours)&&this.renderServiceHours()},t.prototype.render=function(){var e=this;return this.props.open?this.state.editServiceHourOpen?f.a.createElement(X,{adapter:this.getAdapter(),values:this.state.editServiceHourIndex>-1?this.state.serviceHours[this.state.editServiceHourIndex]:{},okButtonText:this.state.editServiceHourIndex>-1?pe("Apply","kunta_api_core"):pe("Add","kunta_api_core"),onOkClick:function(t){e.onServiceHourOk(t)},onClose:function(){e.setState({editServiceHourOpen:!1})}}):this.state.additionalDetailsOpen?f.a.createElement(Q,{channelId:this.props.channelId,channelType:this.props.channelType,open:this.state.additionalDetailsOpen,values:this.state.additionalValues,applyValues:function(t){e.applyAdditionalValues(t)},onClose:function(){e.setState({additionalDetailsOpen:!1})}}):f.a.createElement(O,{locales:de,locale:this.state.locale,saveButtonText:pe("Save","kunta_api_core"),onLocaleChange:function(t){e.changeLocale(t)},onValuesChange:function(t,n){e.updateValues(t,n)},form:"servicechannel/"+this.getForm(),values:this.getValues(this.state.locale),title:he(pe("Edit service channel (%s)","kunta_api_core"),this.state.locale),saveError:this.state.saveError,saving:this.state.saving,open:this.props.open,afterFormRender:function(t,n){return e.afterFormRender(t,n)},onSave:function(){e.saveServiceChannel()},onClose:function(){e.setState({saving:!1,saveError:null}),e.props.onClose()}}):null},t.prototype.onServiceHourOk=function(e){var t=[].concat(this.state.serviceHours);this.state.editServiceHourIndex>-1?t[this.state.editServiceHourIndex]=e:t.push(e),this.setState({editServiceHourIndex:-1,editServiceHourOpen:!1,serviceHours:t.filter(function(e){return!!e&&!!e.type})})},t.prototype.renderServiceHours=function(){var e=this;if(this.$metaform){var t=this.getAdapter().serviceHoursFromForm(this.state.serviceHours).map(function(t){return e.formatServiceHour(t)}),n=this.$metaform.find("table.serviceHours tbody");if(n.empty(),t.length)t.forEach(function(e){var t=jQuery("<tr>").appendTo(n),r=jQuery("<a>").css("margin-right","4px").addClass("btn btn-sm btn-warning remove-service-hour").html(pe("Remove","kunta_api_core")),a=jQuery("<a>").addClass("btn btn-sm btn-success edit-service-hour").html(pe("Edit","kunta_api_core"));jQuery("<td>").html(e).appendTo(t),jQuery("<td>").css({"text-align":"right"}).append(r,a).appendTo(t)});else{var r=jQuery("<tr>").appendTo(n);jQuery("<td>").html("Palveluaikoja ei ole vielä määritelty").appendTo(r)}}},t.prototype.formatServiceHour=function(e){var t=this,n=this.getServiceHourTypeName(e.serviceHourType);if("Exceptional"===e.serviceHourType){var r="("+n+")";e.isClosed&&(r+=" "+pe("Closed","kunta_api_core"));var a=e.openingHour&&e.openingHour.length?e.openingHour[0]:null,o=a?a.from:null,s=a?a.to:null;e.validFrom&&e.validTo?r+=" "+i.formatDateWithTime(e.validFrom,o)+" - "+i.formatDateWithTime(e.validTo,s):e.validFrom&&(r+=" "+i.formatDateWithTimes(e.validFrom,o,s));var c=i.getAnyLocalizedValue(e.additionalInformation);return c?r+" - "+c:r}return 0!==e.openingHour.length||e.isClosed?"("+n+") "+(e.openingHour||[]).map(function(e){return t.formatOpeningHour(e)}).join(","):"("+n+") Aina avoinna (24/7)"},t.prototype.formatOpeningHour=function(e){if(!e)return null;if(null===e.dayFrom)return"";var t=i.getDayName(e.dayFrom,!0);return e.dayTo&&e.dayTo!==e.dayFrom&&(t+=" - "+i.getDayName(e.dayTo,!0)),e.from&&(t+=" "+e.from),e.to&&(t+=" - "+e.to),t},t.prototype.getServiceHourTypeName=function(e){return{OverMidnight:"Päivystys",DaysOfTheWeek:"Normaali",Exceptional:"Poikkeus"}[e]},t.prototype.getAdapter=function(){switch(this.props.channelType){case"electronic":return new D;case"phone":return new ee;case"printableForm":return new ne;case"webpage":return new ae;case"serviceLocation":return new ie}return null},t.prototype.applyAdditionalValues=function(e){this.setState({additionalValues:e,additionalDetailsOpen:!1})},t.prototype.getForm=function(){switch(this.props.channelType){case"electronic":return"electronic";case"phone":return"phone";case"printableForm":return"printable-form";case"webpage":return"webpage";case"serviceLocation":return"service-location"}return this.props.channelType},t.prototype.getSaveAction=function(){switch(this.props.channelType){case"electronic":return"kunta_api_save_electronic_service_channel";case"phone":return"kunta_api_save_phone_service_channel";case"printableForm":return"kunta_api_save_printable_form_service_channel";case"webpage":return"kunta_api_save_webpage_service_channel";case"serviceLocation":return"kunta_api_save_service_location_service_channel"}return null},t.prototype.afterFormRender=function(e,t){t&&(this.$metaform=t,t.on("click",".edit-additional-details",this.onEditAdditionalDetailsClick.bind(this)),t.on("click",".btn.add-service-hour",this.onAddServiceHourClick.bind(this)),t.on("click",".btn.remove-service-hour",this.onRemoveServiceHourClick.bind(this)),t.on("click",".btn.edit-service-hour",this.onEditServiceHourClick.bind(this)),this.renderServiceHours())},t.prototype.onEditAdditionalDetailsClick=function(e){this.setState({additionalDetailsOpen:!0})},t.prototype.onAddServiceHourClick=function(e){this.setState({editServiceHourOpen:!0})},t.prototype.onRemoveServiceHourClick=function(e){var t=jQuery(e.target).closest("tr").index(),n=[].concat(this.state.serviceHours);n.splice(t,1),this.setState({serviceHours:n})},t.prototype.onEditServiceHourClick=function(e){var t=jQuery(e.target).closest("tr").index();this.setState({editServiceHourOpen:!0,editServiceHourIndex:t})},t.prototype.changeLocale=function(e){this.setState({locale:e})},t.prototype.updateValues=function(e,t){var n=ce({},this.state.values);n[e]=t,this.setState({locale:e,values:n})},t.prototype.getValues=function(e){return this.state.values[e]},t.prototype.saveServiceChannel=function(){var e=this,t=wp.apiFetch;this.setState({saving:!0});var n=this.getAdapter().applyToChannel(this.state.values,this.state.additionalValues,this.state.serviceHours,this.props.channel),r=new URLSearchParams;r.append("action",this.getSaveAction()),r.append("serviceChannel",JSON.stringify(n)),t({url:ajaxurl,method:"POST",body:r}).then(function(t){wp.data.dispatch("kunta-api/data").setServiceChannel(e.props.channelType,e.props.channelId,t),e.setState({saving:!1,saveError:null}),e.props.onClose()}).catch(function(t){e.setState({saving:!1,saveError:JSON.stringify(t)})})},t}(f.a.Component),ve=ue(function(e,t){var n=e("kunta-api/data").getServiceChannel,r=t.channelType,a=t.channelId;return{channel:(a?n(r,a):null)||null}})(fe),me=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ye=wp.data.withSelect,ge=wp.i18n.__,be={electronic:{title:ge("Electronic Service Channels","kunta_api_core"),emptyMessage:ge("No attached electronic service channels","kunta_api_core"),searchAction:"search_electronic_service_channels"},phone:{title:ge("Phone Service Channels","kunta_api_core"),emptyMessage:ge("No attached phone service channels","kunta_api_core"),searchAction:"search_phone_service_channels"},printableForm:{title:ge("Printable form Service Channels","kunta_api_core"),emptyMessage:ge("No attached printable form service channels","kunta_api_core"),searchAction:"search_printable_form_service_channels"},webpage:{title:ge("Web page Service Channels","kunta_api_core"),emptyMessage:ge("No attached web page service channels","kunta_api_core"),searchAction:"search_web_page_service_channels"},serviceLocation:{title:ge("Service Location Service Channels","kunta_api_core"),emptyMessage:ge("No attached service location service channels","kunta_api_core"),searchAction:"search_service_location_channels"}},_e=function(e){function t(t){var n=e.call(this,t)||this;return n.state={channelAddOpen:!1,channelAddType:null,channels:t.channels,channelEditOpen:!1,channelEditType:null,channelEditId:null},n}return me(t,e),t.prototype.componentDidUpdate=function(e,t){JSON.stringify(e.channels||{})!==JSON.stringify(this.props.channels||{})&&this.setState({channels:this.props.channels})},t.prototype.render=function(){var e=this;return this.props.open?this.state.channelAddOpen?f.a.createElement(g,{modalTitle:ge("Add Channel","kunta_api_core"),inputLabel:ge("Search Channel","kunta_api_core"),inputHelp:ge("Enter some text to search service channel","kunta_api_core"),searchAction:"kunta_api_"+this.getChannelAddSearchAction(),open:this.state.channelAddOpen,getDisplayName:this.getChannelDisplayName,onSelect:function(t){e.onAddChannelSelect(t)},onClose:function(){return e.setState({channelAddOpen:!1})}}):this.state.channelEditOpen?f.a.createElement(ve,{channelId:this.state.channelEditId,channelType:this.state.channelEditType,open:this.state.channelEditOpen,onClose:function(){return e.setState({channelEditOpen:!1})}}):f.a.createElement(wp.components.Modal,{style:{minWidth:"60%"},title:ge("Service channels","kunta_api_core"),onRequestClose:function(){return e.props.onClose()}},f.a.createElement(wp.components.Panel,{header:ge("Service Channels","kunta_api_core")},Object.keys(be).map(function(t){var n=be[t];return f.a.createElement(wp.components.PanelBody,{title:n.title,initialOpen:!1},e.renderChannels(t),f.a.createElement(wp.components.PanelRow,null,f.a.createElement(wp.components.Button,{className:"is-button",onClick:function(){e.setState({channelAddType:t,channelAddOpen:!0})}},ge("Add channel","kunta_api_core"))))})),f.a.createElement("div",{style:{paddingTop:"15px"}},f.a.createElement(wp.components.Button,{className:"is-button",isDefault:!0,onClick:function(){e.props.applyValues(e.state.channels)}},ge("Apply changes","kunta_api_core")))):null},t.prototype.renderChannels=function(e){var t=this,n=this.state.channels[e];return n&&n.length?n.filter(function(e){return e}).map(function(n){return f.a.createElement(wp.components.PanelRow,null,f.a.createElement("div",null,t.getChannelDisplayName(n)),f.a.createElement("div",{style:{float:"right"}},f.a.createElement(wp.components.Button,{className:"is-button",style:{marginRight:"4px"},onClick:function(){t.onEditChannelClick(e,n)}},ge("Edit","kunta_api_core")),f.a.createElement(wp.components.Button,{className:"is-button",onClick:function(){t.onRemoveChannelClick(e,n)}},ge("Remove","kunta_api_core"))))}):f.a.createElement(wp.components.PanelRow,null,f.a.createElement("div",null,be[e].emptyMessage," "))},t.prototype.getChannelAddSearchAction=function(){return be[this.state.channelAddType].searchAction},t.prototype.onAddChannelSelect=function(e){var t=this.state.channels;switch(this.state.channelAddType){case"electronic":t.electronic=t.electronic.concat(e);break;case"phone":t.phone=t.phone.concat(e);break;case"printableForm":t.printableForm=t.printableForm.concat(e);break;case"webpage":t.webpage=t.webpage.concat(e);break;case"serviceLocation":t.serviceLocation=t.serviceLocation.concat(e)}this.setState({channels:t,channelAddOpen:!1})},t.prototype.onRemoveChannelClick=function(e,t){var n=this.state.channels;switch(e){case"electronic":n.electronic=n.electronic.filter(function(e){return e.id!==t.id});break;case"phone":n.phone=n.phone.filter(function(e){return e.id!==t.id});break;case"printableForm":n.printableForm=n.printableForm.filter(function(e){return e.id!==t.id});break;case"webpage":n.webpage=n.webpage.filter(function(e){return e.id!==t.id});break;case"serviceLocation":n.serviceLocation=n.serviceLocation.filter(function(e){return e.id!==t.id})}this.setState({channels:n})},t.prototype.onEditChannelClick=function(e,t){this.setState({channelEditId:t.id,channelEditType:e,channelEditOpen:!0})},t.prototype.getChannelDisplayName=function(e){var t=e.names||[];return t.sort(function(e,t){return"fi"===e.language?-1:1}),t.length?t[0].value:null},t}(f.a.Component),Se=ye(function(e,t){var n=e("kunta-api/data").getServiceChannel,r=t.channelIds,a={};return Object.keys(be).forEach(function(e){a[e]=(r[e]||[]).filter(function(e){return!!e}).map(function(t){return n(e,t)}).filter(function(e){return!!e})}),{channels:a}})(_e),we=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Te=function(){return(Te=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Ce=function(e,t,n,r){return new(n||(n=Promise))(function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})},Ee=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Oe=wp.data.withSelect,Le=wp.i18n,Pe=Le.__,ke=Le.sprintf,Ae=["fi","sv","en"],Ie=function(e){function t(t){var n=e.call(this,t)||this;return n.state={locale:"fi",saving:!1,saveError:null,additionalDetailsOpen:!1,channelsOpen:!1,values:{},additionalValues:{},channelIds:{electronic:[],phone:[],printableForm:[],serviceLocation:[],webpage:[]}},n}return we(t,e),t.prototype.componentDidUpdate=function(e,t){var n=this.props.service;if(JSON.stringify(n||{})!==JSON.stringify(e.service||{})){var r=new k,a={};Ae.forEach(function(e){a[e]=n?r.serviceToForm(e,n):{}}),this.setState({values:a,additionalValues:n?r.serviceAdditinalToForm(n):{},channelIds:{electronic:n?n.electronicServiceChannelIds:[],phone:n?n.phoneServiceChannelIds:[],printableForm:n?n.printableFormServiceChannelIds:[],serviceLocation:n?n.serviceLocationServiceChannelIds:[],webpage:n?n.webPageServiceChannelIds:[]}})}},t.prototype.render=function(){var e=this;return this.props.open?this.state.channelsOpen?f.a.createElement(Se,{serviceId:this.props.serviceId,channelIds:this.state.channelIds,open:this.state.channelsOpen,applyValues:function(t){return e.applyChannelValues(t)},onClose:function(){e.setState({channelsOpen:!1})}}):this.state.additionalDetailsOpen?f.a.createElement(N,{serviceId:this.props.serviceId,open:this.state.additionalDetailsOpen,values:this.state.additionalValues,applyValues:function(t){e.applyAdditionalValues(t)},onClose:function(){e.setState({additionalDetailsOpen:!1})}}):f.a.createElement(O,{locales:Ae,locale:this.state.locale,saveButtonText:Pe("Save","kunta_api_core"),onLocaleChange:function(t){e.changeLocale(t)},onValuesChange:function(t,n){e.updateValues(t,n)},form:"service/service",values:this.getValues(this.state.locale),title:ke(Pe("Edit service (%s)","kunta_api_core"),this.state.locale),saveError:this.state.saveError,saving:this.state.saving,open:this.props.open,afterFormRender:function(t,n){return e.afterFormRender(t,n)},onSave:function(){e.saveService()},onClose:function(){e.setState({saving:!1,saveError:null}),e.props.onClose()}}):null},t.prototype.applyAdditionalValues=function(e){this.setState({additionalValues:e,additionalDetailsOpen:!1})},t.prototype.applyChannelValues=function(e){this.setState({channelIds:{electronic:e.electronic.map(function(e){return e.id}),phone:e.phone.map(function(e){return e.id}),printableForm:e.printableForm.map(function(e){return e.id}),serviceLocation:e.serviceLocation.map(function(e){return e.id}),webpage:e.webpage.map(function(e){return e.id})},channelsOpen:!1})},t.prototype.afterFormRender=function(e,t){return Ce(this,void 0,void 0,function(){return Ee(this,function(e){return t.on("click",".edit-additional-details",this.onEditAdditionalDetailsClick.bind(this)),t.on("click",".edit-channels",this.onEditChannelsClick.bind(this)),[2]})})},t.prototype.onEditAdditionalDetailsClick=function(e){this.setState({additionalDetailsOpen:!0})},t.prototype.onEditChannelsClick=function(e){this.setState({channelsOpen:!0})},t.prototype.changeLocale=function(e){this.setState({locale:e})},t.prototype.updateValues=function(e,t){var n=Te({},this.state.values);n[e]=t,this.setState({locale:e,values:n})},t.prototype.getValues=function(e){return this.state.values[e]},t.prototype.saveService=function(){var e=this,t=wp.apiFetch;this.setState({saving:!0});var n=(new k).applyToService(this.state.values,this.state.additionalValues,this.state.channelIds,this.props.service),r=new URLSearchParams;r.append("action","kunta_api_save_service"),r.append("service",JSON.stringify(n)),t({url:ajaxurl,method:"POST",body:r}).then(function(t){wp.data.dispatch("kunta-api/data").setService(e.props.serviceId,t),e.setState({saving:!1,saveError:null}),e.props.onClose()}).catch(function(t){e.setState({saving:!1,saveError:JSON.stringify(t)})})},t}(f.a.Component),Ve=Oe(function(e,t){var n=e("kunta-api/data").getService,r=t.serviceId;return{service:r?n(r):{}}})(Ie),ze=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Fe=wp.i18n.__,xe=wp.data.withSelect,Ne=kuntaApiBlocks.allowEdit,je=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isSearchOpen:!1,isEditOpen:!1,component:n.props.component,lang:n.props.lang,serviceId:n.props.serviceId,version:0},n}return ze(t,e),t.prototype.componentDidUpdate=function(e,t){this.state.component!==t.component&&this.props.onComponentChange(this.state.component),this.state.lang!==t.lang&&this.props.onLangChange(this.state.lang),this.state.serviceId!==t.serviceId&&this.props.onServiceIdChange(this.state.serviceId),JSON.stringify(this.props.service)!==JSON.stringify(e.service)&&this.setState({version:this.state.version+1})},t.prototype.render=function(){var e=this,t=["description","userInstruction","languages","electronicServiceChannelIds","phoneServiceChannelIds","printableFormServiceChannelIds","serviceLocationServiceChannelIds","webPageServiceChannelIds"].map(function(e){return{label:Fe("servicecomponent."+e,"kunta_api_core"),value:e}}),n=["fi","sv","en"].map(function(e){return{label:Fe("language."+e,"kunta_api_core"),value:e}});return f.a.createElement("div",null,f.a.createElement("div",null,this.renderChangeButton(),this.renderEditButton(),f.a.createElement("div",{style:{fontSize:"16px"}},f.a.createElement("div",{style:{float:"left",paddingRight:"5px"}},Fe("Current service:","kunta_api_core")),f.a.createElement(wp.components.ServerSideRender,{block:"kunta-api/service",attributes:{serviceId:this.state.serviceId,lang:this.state.lang,component:this.state.component},urlQueryArgs:{displayName:!0,version:this.state.version}}))),f.a.createElement(wp.components.SelectControl,{label:Fe("Component","kunta_api_core"),value:this.state.component,options:t,onChange:function(t){e.setState({component:t})}}),f.a.createElement(wp.components.SelectControl,{label:Fe("Language","kunta_api_core"),value:this.state.lang,options:n,onChange:function(t){e.setState({lang:t})}}),f.a.createElement(g,{modalTitle:Fe("Search Services","kunta_api_core"),inputLabel:Fe("Search Services","kunta_api_core"),inputHelp:Fe("Enter some text to search services","kunta_api_core"),searchAction:"kunta_api_search_services",open:this.state.isSearchOpen,getDisplayName:function(e){var t=e.names||[];return t.sort(function(e,t){return"fi"===e.language?-1:1}),t.length?t[0].value:null},onSelect:function(t){e.setState({isSearchOpen:!1,serviceId:t.id})},onClose:function(){return e.setState({isSearchOpen:!1})}}),f.a.createElement(Ve,{serviceId:this.state.serviceId,open:this.state.isEditOpen,onClose:function(){return e.setState({isEditOpen:!1})}}),f.a.createElement("hr",null),f.a.createElement(wp.components.ServerSideRender,{block:"kunta-api/service",attributes:{serviceId:this.state.serviceId,lang:this.state.lang,component:this.state.component},urlQueryArgs:{preview:!0,version:this.state.version}}))},t.prototype.renderChangeButton=function(){var e=this;return f.a.createElement("div",{style:{float:"right"}},f.a.createElement(wp.components.Button,{isDefault:!0,onClick:function(){return e.setState({isSearchOpen:!0})}},Fe("Change service","kunta_api_core")))},t.prototype.renderEditButton=function(){var e=this;return this.state.serviceId&&Ne?f.a.createElement("div",{style:{float:"right"}},f.a.createElement(wp.components.Button,{style:{marginRight:"2px"},isDefault:!0,onClick:function(){return e.setState({isEditOpen:!0})}},Fe("Edit service","kunta_api_core"))):null},t}(f.a.Component),qe=xe(function(e,t){var n=e("kunta-api/data").getService,r=t.serviceId;return{service:r?n(r):{}}})(je),He=wp.i18n.__;wp.blocks.registerBlockType("kunta-api/service",{title:He("Kunta API Service","kunta_api_core"),icon:f.a.createElement("svg",{"aria-hidden":"true",width:"0.46em",height:"1em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 640 1408"},f.a.createElement("path",{d:"M640 1216v128q0 26-19 45t-45 19H64q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h64V768H64q-26 0-45-19T0 704V576q0-26 19-45t45-19h384q26 0 45 19t19 45v576h64q26 0 45 19t19 45zM512 64v192q0 26-19 45t-45 19H192q-26 0-45-19t-19-45V64q0-26 19-45t45-19h256q26 0 45 19t19 45z",fill:"#626262"})),category:"kunta-api",attributes:{serviceId:{type:"string"},component:{type:"string"},lang:{type:"string"}},edit:function(e){return f.a.createElement(qe,{component:e.attributes.component,lang:e.attributes.lang,serviceId:e.attributes.serviceId,onComponentChange:function(t){e.setAttributes({component:t})},onLangChange:function(t){e.setAttributes({lang:t})},onServiceIdChange:function(t){e.setAttributes({serviceId:t})}})},save:function(){return null}});var De=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Re=wp.data.withSelect,Me=wp.i18n.__,Be=function(e){function t(t){return e.call(this,t)||this}return De(t,e),t.prototype.render=function(){var e=this;return f.a.createElement(wp.components.CheckboxControl,{label:Me("Service location page","kunta_api_core"),checked:this.props.isChecked,onChange:function(t){t?wp.data.dispatch("kunta-api/data").addPageChannel(e.props.channelId):wp.data.dispatch("kunta-api/data").removePageChannel(e.props.channelId)}})},t}(f.a.Component),We=Re(function(e,t){return{isChecked:(0,e("kunta-api/data").isPageChannel)(t.channelId)}})(Be),Je=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ue=wp.i18n.__,Qe=wp.data,Ge=Qe.withSelect,$e=Qe.subscribe,Ye=kuntaApiBlocks.allowEdit,Ke=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isOpen:!1,component:n.props.component,lang:n.props.lang,channelId:n.props.channelId,serviceLocationPage:n.props.serviceLocationPage,isEditOpen:!1,version:0},$e(function(){var e=wp.data.select("kunta-api/data").isPageChannel;n.setState({serviceLocationPage:e(n.state.channelId)})}),n}return Je(t,e),t.prototype.componentDidUpdate=function(e,t){this.state.component!==t.component&&this.props.onComponentChange(this.state.component),this.state.lang!==t.lang&&this.props.onLangChange(this.state.lang),this.state.channelId!==t.channelId&&this.props.onChannelIdChange(this.state.channelId),this.state.serviceLocationPage!==t.serviceLocationPage&&this.props.onServiceLocationPageChange(this.state.serviceLocationPage),JSON.stringify(this.props.channel||{})!==JSON.stringify(e.channel||{})&&this.setState({version:this.state.version+1})},t.prototype.render=function(){var e=this,t=["description","addresses","email","fax","name","phone","phone-charge-info","servicehours","webpages"].map(function(e){return{label:Ue("servicelocationservicechannel."+e,"kunta_api_core"),value:e}}),n=["fi","sv","en"].map(function(e){return{label:Ue("language."+e,"kunta_api_core"),value:e}});return f.a.createElement("div",null,f.a.createElement("div",null,this.renderChangeButton(),this.renderEditButton(),f.a.createElement("div",{style:{fontSize:"16px"}},f.a.createElement("div",{style:{float:"left",paddingRight:"5px"}},Ue("Current service location:","kunta_api_core")),f.a.createElement(wp.components.ServerSideRender,{block:"kunta-api/service-location-service-channel",attributes:{channelId:this.state.channelId,lang:this.state.lang,component:this.state.component},urlQueryArgs:{displayName:!0,version:this.state.version}}))),f.a.createElement(wp.components.SelectControl,{label:Ue("Component","kunta_api_core"),value:this.state.component,options:t,onChange:function(t){e.setState({component:t})}}),f.a.createElement(wp.components.SelectControl,{label:Ue("Language","kunta_api_core"),value:this.state.lang,options:n,onChange:function(t){e.setState({lang:t})}}),f.a.createElement(g,{modalTitle:Ue("Search Services Locations","kunta_api_core"),inputLabel:Ue("Search Services Locations","kunta_api_core"),inputHelp:Ue("Enter some text to search service locations","kunta_api_core"),searchAction:"kunta_api_search_service_location_channels",open:this.state.isOpen,getDisplayName:function(e){var t=e.names||[];return t.sort(function(e,t){return"fi"===e.language?-1:1}),t.length?t[0].value:null},onSelect:function(t){e.setState({isOpen:!1,channelId:t.id})},onClose:function(){return e.setState({isOpen:!1})}}),f.a.createElement(We,{channelId:this.state.channelId,onChange:function(t){e.setState({serviceLocationPage:t})}}),f.a.createElement("hr",null),f.a.createElement(ve,{channelId:this.state.channelId,channelType:"serviceLocation",open:this.state.isEditOpen,onClose:function(){return e.setState({isEditOpen:!1})}}),f.a.createElement(wp.components.ServerSideRender,{block:"kunta-api/service-location-service-channel",attributes:{channelId:this.state.channelId,lang:this.state.lang,component:this.state.component},urlQueryArgs:{preview:!0,version:this.state.version}}))},t.prototype.renderChangeButton=function(){var e=this;return f.a.createElement("div",{style:{float:"right"}},f.a.createElement(wp.components.Button,{isDefault:!0,onClick:function(){return e.setState({isOpen:!0})}},Ue("Change service location","kunta_api_core")))},t.prototype.renderEditButton=function(){var e=this;return this.state.channelId&&Ye?f.a.createElement("div",{style:{float:"right"}},f.a.createElement(wp.components.Button,{style:{marginRight:"2px"},isDefault:!0,onClick:function(){return e.setState({isEditOpen:!0})}},Ue("Edit service location","kunta_api_core"))):null},t}(f.a.Component),Xe=Ge(function(e,t){var n=e("kunta-api/data").getServiceChannel,r=t.channelId;return{channel:r?n("serviceLocation",r):{}}})(Ke),Ze=wp.i18n.__;wp.blocks.registerBlockType("kunta-api/service-location-service-channel",{title:Ze("Kunta API Service Location","kunta_api_core"),icon:f.a.createElement("svg",{"aria-hidden":"true",width:"0.79em",height:"1em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 1408 1792"},f.a.createElement("path",{d:"M1344 0q26 0 45 19t19 45v1664q0 26-19 45t-45 19H64q-26 0-45-19t-19-45V64q0-26 19-45T64 0h1280zM512 288v64q0 14 9 23t23 9h64q14 0 23-9t9-23v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23zm0 256v64q0 14 9 23t23 9h64q14 0 23-9t9-23v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23zm0 256v64q0 14 9 23t23 9h64q14 0 23-9t9-23v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23zm0 256v64q0 14 9 23t23 9h64q14 0 23-9t9-23v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23zm-128 320v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v64q0 14 9 23t23 9h64q14 0 23-9t9-23zm0-256v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v64q0 14 9 23t23 9h64q14 0 23-9t9-23zm0-256v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v64q0 14 9 23t23 9h64q14 0 23-9t9-23zm0-256v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v64q0 14 9 23t23 9h64q14 0 23-9t9-23zm0-256v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v64q0 14 9 23t23 9h64q14 0 23-9t9-23zm512 1280v-192q0-14-9-23t-23-9H544q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm0-512v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v64q0 14 9 23t23 9h64q14 0 23-9t9-23zm0-256v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v64q0 14 9 23t23 9h64q14 0 23-9t9-23zm0-256v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v64q0 14 9 23t23 9h64q14 0 23-9t9-23zm0-256v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v64q0 14 9 23t23 9h64q14 0 23-9t9-23zm256 1024v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v64q0 14 9 23t23 9h64q14 0 23-9t9-23zm0-256v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v64q0 14 9 23t23 9h64q14 0 23-9t9-23zm0-256v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v64q0 14 9 23t23 9h64q14 0 23-9t9-23zm0-256v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v64q0 14 9 23t23 9h64q14 0 23-9t9-23zm0-256v-64q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v64q0 14 9 23t23 9h64q14 0 23-9t9-23z",fill:"#626262"})),category:"kunta-api",attributes:{channelId:{type:"string"},component:{type:"string"},lang:{type:"string"},serviceLocationPage:{type:"boolean"}},edit:function(e){return f.a.createElement(Xe,{component:e.attributes.component,lang:e.attributes.lang,channelId:e.attributes.channelId,serviceLocationPage:e.attributes.serviceLocationPage,onComponentChange:function(t){e.setAttributes({component:t})},onLangChange:function(t){e.setAttributes({lang:t})},onChannelIdChange:function(t){e.setAttributes({channelId:t})},onServiceLocationPageChange:function(t){e.setAttributes({serviceLocationPage:t})}})},save:function(){return null}})}]);