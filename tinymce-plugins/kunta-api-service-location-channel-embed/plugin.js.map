{"version":3,"sources":["../src/kunta-api-service-location-channel-embed/js/plugin.js"],"names":["tinymce","$","SUPPORTED_COMPONENTS","ServiceLocationServiceChannelDialog","editor","serviceLocationServiceChannel","callback","post","ajaxurl","JSON","stringify","response","fail","responseText","statusText","viewModel","getServiceLocationServiceChannelMetaform","formValues","supportedLocales","map","locale","serviceLocationServiceChannelToForm","dialog","openLocalizedMetaformDialog","newFormValues","addClass","updatedChannel","translateServiceLocationServiceChannelFromForm","validationError","validate","showError","saveServiceLocationServiceChannel","err","removeClass","on","_onAddServiceHourClick","bind","_onEditServiceHourClick","_onRemoveServiceHourClick","_onEditAdditionalDetailsClick","redrawServiceHours","serviceHour","getServiceHourMetaform","serviceHourToForm","openMetaformDialog","prepareViewModel","updatedServiceHour","serviceHourFromForm","getAdditionalDetailsMetaform","additionalDetailsToForm","then","additionalDetailsFromForm","find","metaformMultivalueAutocomplete","languageCodes","input","searchCodes","term","codes","codeItem","value","type","code","label","getLocalizedValue","names","catch","tinyMCE","activeEditor","windowManager","alert","areaCodes","areaCode","getCodeNameWithType","addressSubtypes","j","addresses","length","address","subtype","i","push","serviceHourTexts","serviceHours","formatServiceHour","empty","forEach","serviceHourText","row","appendTo","html","append","additionalInformation","isClosed","validForNow","toTime","fromTime","openingHour","dayFrom","dayTo","from","to","isExtra","language","serviceHourType","validFrom","parseIsoDate","validTo","parse","parseInt","day","serviceHourFromFormException","serviceHourFromFormStandard","serviceHourFromFormSpecial","existingLocationServiceChannel","descriptions","emails","phoneNumbers","localeValues","localeAddresses","filter","street","trim","localeAddress","addressIndex","additionalInformations","streetAddress","country","postalCode","postOfficeCode","streetNumber","foreignAddresses","foreign","foreignAddress","foreignAddressIndex","locationAbroad","concat","email","phoneNumber","prefixNumber","number","Object","assign","isFinnishServiceNumber","faxes","fax","webPages","webPage","url","description","shortDescription","moment","open24h","validFromStr","format","validToStr","openingHours","openFrom","openTo","exceptionType","parts","split","hour","minute","result","Error","languageQuery","languages","join","languageQueryResult","languageMap","queryResult","areas","area","municipalities","municipality","getMunicipalityNameWithType","areaType","mucicipalitiesIndex","name","getTypedLocalizedValue","visitAddresses","event","openServiceHourEditDialog","createdServiceHour","openAdditionalDetailsEditDialog","target","closest","index","splice","window","KuntaApiAbstractEditDialog","ServiceLocationServiceChannelEditor","buttonStyle","onBeforeSetcontent","onGetContent","onDblClick","addCommand","onServiceLocationChannelEdit","string","re","match","exec","title","content","replace","all","tag","attributesText","end","attributes","parseAttributes","placeholder","attr","css","attribute","component","getComponentTitle","shortcodeAttributes","attributeNames","attributeName","attributeValue","element","placeholderAttr","serviceLocationServiceChannelId","execCommand","id","replaceShortcodes","restoreShortcodes","openElementEditor","ui","options","findServiceLocationServiceChannel","open","ServiceLocationServiceChannelEmbed","displayLocale","searching","pending","addButton","onclick","width","height","body","onKeyUp","e","searchServiceLocationChannels","innerResponse","handleResponse","classes","text","minHeight","onsubmit","responseHtml","allEmbedsFromSameChannel","componentsToEmbed","firstServiceLocationChannelId","first","serviceLocationChannelName","each","serviceLocationChannelId","confirm","confirmed","pageId","val","markAsServiceLocationPage","insertContent","query","remove","values","resultContainer","getLocalizedValueAndType","keys","appendResult","PluginManager","add","jQuery"],"mappings":"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","file":"plugin.js","sourcesContent":["/* jshint esversion: 6 */\n/* global ajaxurl, tinymce, moment, Promise */\n((tinymce, $) => {\n  \n  const SUPPORTED_COMPONENTS = {\n    'name': {\n      'title': 'Palvelupisteen nimi'\n    },\n    'description': {\n      'title': 'Palvelupisteen kuvaus'\n    },\n    'email': {\n      'title': 'Palvelupisteen sähköpostiosoitteet'\n    },\n    'addresses': {\n      'title': 'Palvelupisteen osoitetiedot'\n    },\n    'fax': {\n      'title': 'Palvelupisteen faksi'\n    },\n    'phone': {\n      'title': 'Palvelupisteen puhelinnumerot'\n    },\n    'servicehours': {\n      'title': 'Palvelupisteen aukioloajat'\n    },\n    'webpages': {\n      'title': 'Palvelupisteen verkkosivustot'\n    }\n  };\n  \n  class ServiceLocationServiceChannelDialog extends window.KuntaApiAbstractEditDialog {\n    \n    /**\n     * Constructs service location service channel dialog\n     * \n     * @param {type} editor TinyMCE editor instance\n     * @param {type} serviceLocationServiceChannel\n     */\n    constructor(editor, serviceLocationServiceChannel) {\n      super(editor);\n      this.serviceLocationServiceChannel = serviceLocationServiceChannel;\n    }\n    \n    saveServiceLocationServiceChannel(serviceLocationServiceChannel, callback) {\n      $.post(ajaxurl, {\n        'action': 'kunta_api_save_service_location_service_channel',\n        'serviceLocationServiceChannel': JSON.stringify(this.serviceLocationServiceChannel)\n      }, (response) => {\n        callback();\n      })\n      .fail((response) => {\n        callback(response.responseText || response.statusText || \"Unknown error occurred\");\n      });\n    }\n    \n    open() {\n      const viewModel = getServiceLocationServiceChannelMetaform();\n      const formValues = {};\n      this.supportedLocales.map((locale) => {\n        formValues[locale] = this.serviceLocationServiceChannelToForm(locale, this.serviceLocationServiceChannel);\n      });\n      \n      const dialog = this.openLocalizedMetaformDialog(viewModel, formValues, (newFormValues) => {\n        dialog.dialog(\"widget\").addClass('loading');\n        \n        const updatedChannel = this.translateServiceLocationServiceChannelFromForm(this.serviceLocationServiceChannel, newFormValues);\n        const validationError = this.validate(updatedChannel);\n        \n        if (validationError !== null) {\n          this.showError('Virheellinen syöte', validationError);\n        } else {\n          this.serviceLocationServiceChannel = updatedChannel;\n          \n          this.saveServiceLocationServiceChannel(this.serviceLocationServiceChannel, (err) => {\n            dialog.dialog(\"widget\").removeClass('loading');\n            if (err) {\n              this.showError('Virhe tallentaessa', err);\n            } else {\n              dialog.dialog('close'); \n            }\n          });\n        }\n      });\n      \n      $(dialog).on('click', '.add-service-hour', this._onAddServiceHourClick.bind(this));\n      $(dialog).on('click', '.edit-service-hour', this._onEditServiceHourClick.bind(this));\n      $(dialog).on('click', '.remove-service-hour', this._onRemoveServiceHourClick.bind(this));\n      $(dialog).on('click', '.edit-additional-details', this._onEditAdditionalDetailsClick.bind(this));\n      \n      this.redrawServiceHours();\n    }\n    \n    openServiceHourEditDialog(serviceHour, callback) {\n      const viewModel = getServiceHourMetaform();\n      const formValues = this.serviceHourToForm(serviceHour);\n      const dialog = this.openMetaformDialog(this.prepareViewModel(viewModel), formValues, (newFormValues) => {\n        const updatedServiceHour = this.serviceHourFromForm(newFormValues);\n        callback(updatedServiceHour);\n      });\n    }\n    \n    openAdditionalDetailsEditDialog() {\n      const viewModel = getAdditionalDetailsMetaform();\n      this.additionalDetailsToForm(this.serviceLocationServiceChannel).then((formValues) => {\n        const dialog = this.openMetaformDialog(this.prepareViewModel(viewModel), formValues, (newFormValues) => {\n          this.additionalDetailsFromForm(newFormValues);\n        });\n\n        dialog.find('*[data-name=\"languages\"]')\n          .metaformMultivalueAutocomplete('val', formValues.languageCodes)\n          .metaformMultivalueAutocomplete('option', 'customSource', (input, callback) => {\n            this.searchCodes(\"Language\", input.term + '*')\n              .then((codes) => {\n                callback(codes.map((codeItem) => {\n                  return {\n                    value: `${codeItem.type}:${codeItem.code}`,\n                    label: this.getLocalizedValue(codeItem.names, 'fi')\n                  };\n                }));\n              })\n              .catch((err) => {\n                tinyMCE.activeEditor.windowManager.alert(err);\n              });\n          });\n\n        dialog.find('*[data-name=\"areas\"]')\n          .metaformMultivalueAutocomplete('val', formValues.areaCodes)\n          .metaformMultivalueAutocomplete('option', 'customSource', (input, callback) => {\n            this.searchCodes(\"Municipality,Province,HospitalRegions,BusinessRegions\", input.term + '*')\n              .then((codes) => {\n                callback(codes.map((areaCode) => {\n                  return {\n                    value: `${areaCode.type}:${areaCode.code}`,\n                    label: this.getCodeNameWithType(areaCode)\n                  };\n                }));\n              })\n              .catch((err) => {\n                tinyMCE.activeEditor.windowManager.alert(err);\n              });\n          });\n      \n      });\n      \n    }\n    \n    validate(serviceLocationServiceChannel) {\n      const addressSubtypes = [];\n      \n      for (let j = 0; j < serviceLocationServiceChannel.addresses.length; j++) {\n        const address = serviceLocationServiceChannel.addresses[j];\n        if (address.subtype === \"Abroad\" || address.subtype === \"Single\") {\n          for (let i = 0; i < addressSubtypes.length; i++) {\n            if (addressSubtypes[i] !== address.subtype) {\n              return \"Toimipisteellä ei voi olla yhtäaikaa kotimaista ja ulkomaista osoitetta\"; \n            }\n          }\n        }\n        \n        addressSubtypes.push(address.subtype);\n      }\n      \n      return null;\n    }\n    \n    redrawServiceHours() {\n      const serviceHourTexts = this.serviceLocationServiceChannel.serviceHours.map((serviceHour) => {\n        return this.formatServiceHour(serviceHour);\n      });\n      \n      $('table.serviceHours tbody').empty();\n      \n      if (serviceHourTexts.length) {\n        serviceHourTexts.forEach((serviceHourText) => {\n          const row = $('<tr>').appendTo($('table.serviceHours tbody'));\n          $('<td>').html(serviceHourText).appendTo(row);\n          $('<td>').append($('<a>').addClass('btn btn-sm btn-warning remove-service-hour').html('Poista')).appendTo(row);\n          $('<td>').append($('<a>').addClass('btn btn-sm btn-success edit-service-hour').html('Muokkaa')).appendTo(row);\n        });\n      } else {\n        $('<tr>')\n          .append($('<td>').html('Palveluaikoja ei ole vielä määritelty'))\n          .appendTo($('table.serviceHours tbody'));\n      }\n    }\n    \n    serviceHourFromFormException(formValues) {\n      const additionalInformation = [];\n      const isClosed = formValues.type === 'closed-all-day';\n      const validForNow = false;\n      const toTime = isClosed ? null : formValues[`Exception-to-time`];\n      const fromTime = isClosed ? null : formValues[`Exception-from-time`];\n      const openingHour = [];\n      \n      if (toTime || fromTime) {\n        openingHour.push({\n          dayFrom: null,\n          dayTo: null,\n          from: fromTime,\n          to: toTime,\n          isExtra: false\n        });\n      }\n      \n      this.supportedLocales.forEach((locale) => {\n        const value = formValues[`Exception-additional-information-${locale}`];\n        if (value) {\n          additionalInformation.push({\n            language: locale,\n            value: value\n          });  \n        }\n      });\n      \n      return {\n        serviceHourType: formValues.type,\n        validFrom: this.parseIsoDate(formValues[`Exception-from-date`]),\n        validTo: this.parseIsoDate(formValues[`Exception-to-date`]),\n        isClosed: isClosed,\n        validForNow: validForNow,\n        additionalInformation: additionalInformation,\n        openingHour: openingHour\n      };\n    }\n    \n    serviceHourFromFormStandard(formValues) {\n      const isClosed = false;\n      const validForNow = formValues[`${formValues.type}-validForNow`] === \"true\";\n      const additionalInformation = [];\n      const serviceHours = JSON.parse(formValues['Standard-openinghours']);\n      const openingHour = formValues['Standard-open24h'] ? [] : serviceHours.map((serviceHour) => {\n        return {\n          dayFrom: parseInt(serviceHour.day),\n          dayTo: parseInt(serviceHour.day),\n          from: serviceHour.from,\n          to: serviceHour.to,\n          isExtra: false\n        };\n      });\n      \n      return {\n        serviceHourType: formValues.type,\n        validFrom: validForNow ? null : this.parseIsoDate(formValues[`${formValues.type}-validFrom`]),\n        validTo: validForNow ? null : this.parseIsoDate(formValues[`${formValues.type}-validTo`]),\n        isClosed: isClosed,\n        validForNow: validForNow,\n        additionalInformation: additionalInformation,\n        openingHour: openingHour\n      };\n    }\n    \n    serviceHourFromFormSpecial(formValues) {\n      const isClosed = false;\n      const validForNow = formValues[`${formValues.type}-validForNow`] === \"true\";\n      const additionalInformation = [];\n      const openingHour = [{\n        dayFrom: parseInt(formValues['Special-from-date']),\n        dayTo: parseInt(formValues['Special-to-date']),\n        from: formValues['Special-from-time'],\n        to: formValues['Special-to-time'],\n        isExtra: false\n      }];\n    \n      return {\n        serviceHourType: formValues.type,\n        validFrom: validForNow ? null : this.parseIsoDate(formValues[`${formValues.type}-validFrom`]),\n        validTo: validForNow ? null : this.parseIsoDate(formValues[`${formValues.type}-validTo`]),\n        isClosed: isClosed,\n        validForNow: validForNow,\n        additionalInformation: additionalInformation,\n        openingHour: openingHour\n      };\n    }\n    \n    serviceHourFromForm(formValues) {\n      const serviceHourType = formValues.type;\n      switch (serviceHourType) {\n        case \"Exception\":\n          return this.serviceHourFromFormException(formValues);\n        case \"Standard\":\n          return this.serviceHourFromFormStandard(formValues);\n        case \"Special\":\n          return this.serviceHourFromFormSpecial(formValues);\n      };\n    }\n    \n    translateServiceLocationServiceChannelFromForm(existingLocationServiceChannel, formValues) {\n      const serviceLocationServiceChannel = JSON.parse(JSON.stringify(existingLocationServiceChannel));\n      serviceLocationServiceChannel.addresses = [];\n      serviceLocationServiceChannel.descriptions = [];\n      serviceLocationServiceChannel.emails = [];\n      serviceLocationServiceChannel.phoneNumbers = [];\n      \n      this.supportedLocales.forEach((locale) => {\n        const localeValues = formValues[locale];\n        \n        const localeAddresses = JSON.parse(localeValues.addresses).filter((address) => {\n          return !!address.street && !!address.street.trim();\n        });\n        \n        localeAddresses.forEach((localeAddress, addressIndex) => {\n          let address;\n          if (serviceLocationServiceChannel.addresses.length - 1 < addressIndex) {\n            address = {\n              additionalInformations: [],\n              streetAddress: [],\n              subtype: 'Single',\n              type: 'Location',\n              country: 'FI'\n            };\n            \n            serviceLocationServiceChannel.addresses.push(address);\n          } else {\n            address = serviceLocationServiceChannel.addresses[addressIndex];\n          }\n          \n          if (localeAddress.additionalInformation) {\n            localeAddress.additionalInformation = localeAddress.additionalInformation.trim();\n          }\n          \n          if (localeAddress.additionalInformation) {\n            address.additionalInformations.push({\n              \"language\": locale,\n              \"value\": localeAddress.additionalInformation\n            });\n          }\n        \n          address.streetAddress.push({\n            \"language\": locale,\n            \"value\": localeAddress.street\n          });\n          \n          address.postalCode = localeAddress.postOfficeCode;\n          address.streetNumber = localeAddress.streetNumber;\n        });\n        \n        const foreignAddresses = JSON.parse(localeValues.foreignAddresses).filter((address) => {\n          return !!address.foreign;\n        });\n        \n        foreignAddresses.forEach((foreignAddress, foreignAddressIndex) => {\n          const addressIndex = localeAddresses.length + foreignAddressIndex;\n          \n          let address;\n          if (serviceLocationServiceChannel.addresses.length - 1 < addressIndex) {\n            address = {\n              subtype: 'Abroad',\n              type: 'Location',\n              locationAbroad: []\n            };            \n            serviceLocationServiceChannel.addresses.push(address);\n          } else {\n            address = serviceLocationServiceChannel.addresses[addressIndex];\n          }\n          \n          address.locationAbroad.push({\n            \"language\": locale,\n            \"value\": foreignAddress.foreign\n          });\n        });\n        \n        serviceLocationServiceChannel.emails = serviceLocationServiceChannel.emails.concat(\n          JSON.parse(localeValues.emails)\n            .filter((email) => {\n              return !!email.email;\n            })\n            .map((email) => {\n              return {\n                \"language\": locale,\n                \"value\": email.email\n              };\n            })\n        );\n\n        serviceLocationServiceChannel.phoneNumbers = serviceLocationServiceChannel.phoneNumbers.concat(\n          JSON.parse(localeValues.phoneNumbers)\n            .filter((phoneNumber) => {\n              return !!phoneNumber.prefixNumber && !!phoneNumber.number;\n            })\n            .map((phoneNumber) => {\n              return Object.assign(phoneNumber, {\n                \"type\": \"Phone\",\n                \"language\": locale,\n                \"isFinnishServiceNumber\": phoneNumber.isFinnishServiceNumber === \"true\"\n              });\n            })\n        );\n\n        serviceLocationServiceChannel.phoneNumbers = serviceLocationServiceChannel.phoneNumbers.concat(\n          JSON.parse(localeValues.faxes)\n            .filter((fax) => {\n              return !!fax.prefixNumber && !!fax.number;\n            })\n            .map((fax) => {\n              return {\n                \"type\": \"Fax\",\n                \"language\": locale,\n                \"number\": fax.number,\n                \"prefixNumber\": fax.prefixNumber,\n                \"isFinnishServiceNumber\": false\n              };\n            })\n        );\n\n        serviceLocationServiceChannel.webPages = serviceLocationServiceChannel.webPages.concat(\n          JSON.parse(localeValues.webPages)\n            .filter((webPage) => {\n              return !!webPage.url;\n            })\n            .map((webPage) => {\n              return Object.assign(webPage, {\n                \"language\": locale\n              });\n            })\n        );\n        \n        if (localeValues.description) {\n          localeValues.description = localeValues.description.trim();\n        }\n        \n        if (localeValues.description) {\n          serviceLocationServiceChannel.descriptions.push({\n            \"language\": locale,\n            \"value\": localeValues.description,\n            \"type\": \"Description\"\n          });\n        }\n        \n        if (localeValues.shortDescription) {\n          localeValues.shortDescription = localeValues.shortDescription.trim();\n        }\n      \n        if (localeValues.shortDescription) {\n          serviceLocationServiceChannel.descriptions.push({\n            \"language\": locale,\n            \"value\": localeValues.shortDescription,\n            \"type\": \"ShortDescription\"\n          });\n        }\n      });\n      \n      return serviceLocationServiceChannel;\n    }\n    \n    serviceHourToForm(serviceHour) {\n      if (!serviceHour) {\n        return {};\n      }\n      \n      const type = serviceHour.serviceHourType;\n      const validForNow = serviceHour.validForNow ? \"true\" : \"false\";\n      const validFrom = serviceHour.validForNow || !serviceHour.validFrom ? null : moment(serviceHour.validFrom);\n      const validTo = serviceHour.validForNow || !serviceHour.validTo ? null : moment(serviceHour.validTo);\n      const open24h = serviceHour.openingHour.length === 0 && !serviceHour.isClosed;\n      const validFromStr = validFrom ? validFrom.format() : null;\n      const validToStr = validTo ? validTo.format() : null;\n      const openingHour = serviceHour.openingHour && serviceHour.openingHour.length ? serviceHour.openingHour[0] : null;\n      const openingHours = [];\n          \n      (serviceHour.openingHour||[]).forEach((openingHour) => {\n        for (let day = openingHour.dayFrom; day <= openingHour.dayTo; day++) {\n          openingHours.push({\n            day: day,\n            from: openingHour.from,\n            to: openingHour.to\n          });\n        };\n      });\n      \n      switch (type) {\n        case 'Standard':\n          return {\n            'type': type,\n            'Standard-validForNow': validForNow,\n            'Standard-validFrom': validFromStr,\n            'Standard-validTo': validToStr,\n            'Standard-open24h': open24h,\n            'Standard-openinghours': openingHours\n          };\n        case 'Special':\n          return {\n            'type': type,\n            'Special-validForNow': validForNow,\n            'Special-validFrom': validFromStr,\n            'Special-validTo': validToStr,\n            'Special-from-date': openingHour ? openingHour.dayFrom : null,\n            'Special-from-time': openingHour ? openingHour.from : null,\n            'Special-to-date': openingHour ? openingHour.dayTo : null,\n            'Special-to-time': openingHour ? openingHour.to : null\n          };\n        case 'Exception':\n          const openFrom = openingHour ? openingHour.from : null;\n          const openTo = openingHour ? openingHour.to : null;\n          const exceptionType = !validTo ? !openFrom && !openTo ? 'closed-all-day' : 'single' : 'range';\n          \n          if (validFrom && openFrom) {\n            const parts = openFrom.split(':');\n            validFrom.hour(parseInt(parts[0]));\n            validFrom.minute(parseInt(parts[1]));\n          }\n          \n          if (validTo && openTo) {\n            const parts = openTo.split(':');\n            validTo.hour(parseInt(parts[0]));\n            validTo.minute(parseInt(parts[1]));\n          }\n          \n          const result = {\n            'type': type,\n            'Exception-type': exceptionType,\n            'Exception-from-date': validFrom ? validFrom.format() : null,\n            'Exception-to-date': validTo ? validTo.format() : null,\n            'Exception-from-time': openFrom,\n            'Exception-to-time': openTo\n          };\n          \n          this.supportedLocales.forEach((locale) => {\n            result[`Exception-additional-information-${locale}`] = this.getLocalizedValue(serviceHour.additionalInformation, locale);\n          });\n          \n          return result;\n        default:\n          throw new Error(`Unknown service hour type ${type}`);\n        break;\n      }\n    }\n    \n    additionalDetailsToForm(serviceLocationServiceChannel) {\n      const languageQuery = serviceLocationServiceChannel.languages.map((language) => {\n        return `code:${language}`;\n      }).join(' ');\n      \n      return this.searchCodes(\"Language\", `+(${languageQuery})`)\n        .then((languageQueryResult) => {\n          const languageMap = {};\n          languageQueryResult.forEach((queryResult) => {\n            languageMap[queryResult.code] = this.getLocalizedValue(queryResult.names, 'fi');\n          });\n  \n          const languageCodes = serviceLocationServiceChannel.languages.map((language) => {\n            return {\n              value: language,\n              label: languageMap[language] || language\n            };\n          });\n          \n          const areaCodes = [];\n          serviceLocationServiceChannel.areas.forEach((area) => {\n            if (area.type !== 'Municipality') {\n              areaCodes.push({\n                value: `${area.type}:${area.code}`,\n                label: this.getCodeNameWithType(area)\n              });\n            } else {\n              area.municipalities.forEach((municipality) => {\n                areaCodes.push({\n                  value: `Municipality:${municipality.code}`,\n                  label: this.getMunicipalityNameWithType(municipality)\n                });\n              });\n            }\n          });\n          \n          return {\n            languageCodes: languageCodes,\n            areaCodes: areaCodes,\n            areaType: serviceLocationServiceChannel.areaType\n          };\n        });\n    }\n    \n    additionalDetailsFromForm(newFormValues) {\n      this.serviceLocationServiceChannel.areaType = newFormValues.areaType;\n      this.serviceLocationServiceChannel.languages = (newFormValues.languages||'').split(',');\n      \n      if (newFormValues.areaType === 'AreaType') {\n        let mucicipalitiesIndex = -1;\n        const areas = [];\n        \n        (newFormValues.areas||'').split(',').forEach((area) => {\n          const parts = area.split(':');\n          const type = parts[0];\n          const code = parts[1];\n          \n          if (type === 'Municipality') {\n            if (mucicipalitiesIndex > -1) {\n              areas[mucicipalitiesIndex].municipalities.push({\n                code: code\n              });\n            } else {\n              mucicipalitiesIndex = areas.push({\n                'type': 'Municipality',\n                'municipalities': [{\n                  code: code\n                }]\n              }) - 1;\n            }\n          } else {\n            areas.push({\n              type: type,\n              code: code\n            });\n          }\n        });\n        \n        this.serviceLocationServiceChannel.areas = areas;\n      }\n    }\n   \n    serviceLocationServiceChannelToForm(locale, serviceLocationServiceChannel) {\n      const name = this.getTypedLocalizedValue(serviceLocationServiceChannel.names, locale, 'Name');\n      const shortDescription = this.getTypedLocalizedValue(serviceLocationServiceChannel.descriptions, locale, 'ShortDescription');\n      const description = this.getTypedLocalizedValue(serviceLocationServiceChannel.descriptions, locale, 'Description');\n      const visitAddresses = serviceLocationServiceChannel.addresses.filter((address) => {\n        return address.subtype !== 'Abroad';\n      });\n      \n      const foreignAddresses = serviceLocationServiceChannel.addresses.filter((address) => {\n        return address.subtype === 'Abroad';\n      });\n      \n      const emails = serviceLocationServiceChannel.emails.filter((email) => {\n        return locale === email.language;\n      });\n      \n      const faxes = serviceLocationServiceChannel.phoneNumbers.filter((phoneNumber) => {\n        return phoneNumber.type === 'Fax' && locale === phoneNumber.language;\n      });\n      \n      const phoneNumbers = serviceLocationServiceChannel.phoneNumbers.filter((phoneNumber) => {\n        return phoneNumber.type === 'Phone' && locale === phoneNumber.language;\n      });\n      \n      const webPages = serviceLocationServiceChannel.webPages.filter((webPage) => {\n        return locale === webPage.language;\n      });\n      \n      const addresses = visitAddresses.map((address) => {\n        return {\n          street: this.getLocalizedValue(address.streetAddress, locale),\n          streetNumber: address.streetNumber,\n          postOfficeCode: address.postalCode,\n          additionalInformation: this.getLocalizedValue(address.additionalInformations, locale) \n        };\n      });\n      \n      return {\n        name: name,\n        description: description,\n        shortDescription: shortDescription,\n        addresses: addresses,\n        emails: emails.map((email) => {\n          return {\n            email: email.value\n          };\n        }),\n        phoneNumbers: phoneNumbers.map((phoneNumber) => {\n          return Object.assign(phoneNumber, {\n            isFinnishServiceNumber: phoneNumber.isFinnishServiceNumber ? 'true' : 'false'\n          });\n        }),\n        faxes: faxes,\n        foreignAddresses: foreignAddresses.map((foreignAddress) => {\n          return {\n            foreign: this.getLocalizedValue(foreignAddress.locationAbroad, locale)\n          };\n        }),\n        webPages: webPages\n      };\n    }\n    \n    _onAddServiceHourClick(event) {\n      this.openServiceHourEditDialog(null, (createdServiceHour) => {\n        this.serviceLocationServiceChannel.serviceHours.push(createdServiceHour);\n        this.redrawServiceHours();\n      });\n    }\n    \n    _onEditAdditionalDetailsClick() {\n      this.openAdditionalDetailsEditDialog(this.serviceLocationServiceChannel);\n    }\n    \n    _onEditServiceHourClick(event) {\n      const row = $(event.target).closest('tr');\n      const index = row.index();\n      const serviceHour = this.serviceLocationServiceChannel.serviceHours[index];\n      \n      this.openServiceHourEditDialog(serviceHour, (updatedServiceHour) => {\n        this.serviceLocationServiceChannel.serviceHours.splice(index, 1, updatedServiceHour);\n        this.redrawServiceHours();\n      });\n    }\n    \n    _onRemoveServiceHourClick(event) {\n      const row = $(event.target).closest('tr');\n      const index = row.index();\n      this.serviceLocationServiceChannel.serviceHours.splice(index, 1);\n      this.redrawServiceHours();\n    }\n    \n  }\n  \n  class ServiceLocationServiceChannelEditor {\n    \n    constructor (editor) {\n      this.buttonStyle = {\n        'color': '#555',\n        'width': '100%',\n        'border': '1px solid #ccc',\n        'background': '#f7f7f7',\n        'display': 'block',\n        'padding': '5px',\n        'margin-top': '5px',\n        'margin-bottom': '5px',\n        'cursor': 'pointer'\n      };\n      \n      this.editor = editor;\n      \n      this.editor.on('BeforeSetcontent', this.onBeforeSetcontent.bind(this));\n      this.editor.on('GetContent', this.onGetContent.bind(this));\n      this.editor.on('DblClick', this.onDblClick.bind(this));\n      this.editor.addCommand('kunta-api-service-location-channel-edit', this.onServiceLocationChannelEdit.bind(this));\n    }\n    \n    parseAttributes (string) {\n      const result = [];\n      const re = /([a-zA-Z-_]*)(\\=\\\")([a-zA-Z0-9-]*)(\\\")/g;\n      let match = null;\n      \n      do {\n        match = re.exec(string);\n        if (match && match.length > 3) {\n          result.push({\n            name: match[1],\n            value: match[3] \n          });\n        }\n      } while (match);\n\n      return result;\n    }\n    \n    getComponentTitle (name) {\n      return SUPPORTED_COMPONENTS[name].title;\n    }\n    \n    replaceShortcodes(content) {\n      return content.replace(/(\\[kunta_api_location_channel_component)([a-zA-Z0-9 -=]*)(\\])/g, (all, tag, attributesText, end) => {\n        const attributes = this.parseAttributes(attributesText);\n        const placeholder = $('<input>')\n          .attr({\n           'type': 'button',\n           'data-kunta-api-placeholder': 'location_channel_component'\n          })\n          .css(this.buttonStyle);\n          \n        for (let i = 0; i < attributes.length; i++) {\n          const attribute = attributes[i];\n          placeholder.attr('data-' + attribute.name, attribute.value);\n        }\n        \n        const component = placeholder.attr('data-component');\n        if (!SUPPORTED_COMPONENTS[component]) {\n          return all;\n        }\n        \n        placeholder.attr('value', this.getComponentTitle(component));\n        return $('<div>').append(placeholder).html();\n      });\n      \n    }\n    \n    restoreShortcodes(content) {\n      return content.replace(/<input [^>]+>/g, (match) => {\n        const input = $(match);\n        \n        if (input.attr('data-kunta-api-placeholder') === 'location_channel_component') {\n          const shortcodeAttributes = [];\n          const attributeNames = ['channel-id', 'component'];\n          \n          for (let i = 0; i < attributeNames.length; i++) {\n            const attributeName = attributeNames[i];\n            const attributeValue = input.attr('data-' + attributeName);\n            shortcodeAttributes.push([attributeName, '\"' + attributeValue + '\"'].join('='));\n          }\n          \n          return '[kunta_api_location_channel_component ' + shortcodeAttributes.join(' ') + ']';\n        }\n        \n        return match;\n      });\n    }\n    \n    openElementEditor(element) {\n      const placeholderAttr = element.attributes['data-kunta-api-placeholder'];\n      if (placeholderAttr) {\n        const serviceLocationServiceChannelId = element.attributes['data-channel-id'].value;\n        this.editor.execCommand('kunta-api-service-location-channel-edit', '', {\n          serviceLocationServiceChannelId: serviceLocationServiceChannelId\n        });\n      }\n    }\n    \n    findServiceLocationServiceChannel(id, callback) {\n      $.post(ajaxurl, {\n        'action': 'kunta_api_load_service_location_service_channel',\n        'serviceLocationServiceChannelId': id\n      }, (response) => {\n        callback(null, JSON.parse(response));\n      })\n      .fail((response) => {\n        callback(response.responseText || response.statusText);\n      });\n    }\n      \n    onBeforeSetcontent(event) {\n      event.content = this.replaceShortcodes(event.content);\n    }\n    \n    onGetContent(event) {\n      event.content = this.restoreShortcodes(event.content);\n    }\n    \n    onDblClick(event) {\n      const element = event.target;\n      this.openElementEditor(element);\n    }\n\n    onServiceLocationChannelEdit(ui, options) {\n      this.findServiceLocationServiceChannel(options.serviceLocationServiceChannelId, (err, serviceLocationServiceChannel) => {\n        if (err) {\n          tinyMCE.activeEditor.windowManager.alert(err);\n        } else {\n          const dialog = new ServiceLocationServiceChannelDialog(this.editor, serviceLocationServiceChannel);\n          dialog.open();\n        }\n      });\n    } \n    \n  }\n  \n  class ServiceLocationServiceChannelEmbed {\n    \n    constructor (editor) {\n      this.editor = editor;\n      this.displayLocale = 'fi';\n      this.searching = false;\n      this.pending = false;\n      this.addButton();\n    }\n    \n    addButton () {\n      this.editor.addButton('kunta_api_service_location_embed', {\n        title: 'Search Kunta API service location channels',\n        onclick: () => {\n          this.editor.windowManager.open({\n            title: 'Search Kunta API service location channels',\n            width: 768,\n            height: 500,\n            body: [\n              { type: 'textbox', name: 'kunta-api-service-query', label: 'Query', onKeyUp: (e) => {     \n                if (!this.searching) {\n                  this.searching = true;\n                  this.searchServiceLocationChannels(e.target.value, (response) => {\n                    this.searching = false;\n                    if (this.pending) {\n                      this.searchServiceLocationChannels(e.target.value, (innerResponse) => {\n                        this.handleResponse(innerResponse);\n                      });\n                    } else {\n                      this.handleResponse(response);\n                    }\n                  });\n                } else {\n                  this.pending = true;\n                }\n              }},\n              {type: 'label', classes: 'kunta-api-search-info', text: \"Kirjoita hakusana yllä olevaan hakukenttään\"},\n              {type: 'container', classes: 'kunta-api-search-results', minHeight: 400}\n            ],\n            onsubmit: (e) => {\n              let responseHtml = '';\n              let allEmbedsFromSameChannel = true;              \n              const componentsToEmbed = $('.service-component-embed-input:checked');\n              const firstServiceLocationChannelId = componentsToEmbed.first().attr('data-service-location-channel-id');\n              const serviceLocationChannelName = componentsToEmbed.first().attr('data-service-location-channel-name');\n              \n              componentsToEmbed.each(function () {\n                var component = $(this).attr('data-component-type');\n                var serviceLocationChannelId = $(this).attr('data-service-location-channel-id');\n                responseHtml += '[kunta_api_location_channel_component channel-id=\"'+ serviceLocationChannelId +'\" component=\"'+ component +'\"]';\n                if (serviceLocationChannelId !== firstServiceLocationChannelId) {\n                  allEmbedsFromSameChannel = false;\n                }\n              });\n\n              if (allEmbedsFromSameChannel) {\n                this.editor.windowManager.confirm(\"Merkitäänkö sivu palvelukanavan: \"+ serviceLocationChannelName + \" sivuksi?\", function(confirmed) {\n                  if (confirmed) {\n                    const pageId = $('#post_ID').val();\n                    this.markAsServiceLocationPage(firstServiceLocationChannelId, pageId);\n                  }\n                });\n              }\n\n              this.editor.insertContent(responseHtml);\n            }\n          });\n        }\n      });\n    }\n    \n    markAsServiceLocationPage(serviceLocationChannelId, pageId) {\n      $.post( ajaxurl, {\n        'action': 'kunta_api_mark_page_as_location_page',\n        'pageId': pageId,\n        'locationChannelId': serviceLocationChannelId\n      }, (response) => {\n      });\n    }\n    \n    searchServiceLocationChannels(query, callback) {\n      $('.mce-kunta-api-search-results').empty();\n      $('.mce-kunta-api-search-results').append($('<div>').addClass('mce-kunta-api-search-results-loader'));\n      $('.mce-kunta-api-search-info').text('Ladataan...');\n      $.post(ajaxurl, {\n        'action': 'kunta_api_search_service_location_channels',\n        'data': query\n      }, (response) => {\n        $('.mce-kunta-api-search-results-loader').remove();\n        callback(JSON.parse(response));\n      });\n    }\n    \n    getLocalizedValueAndType(values, locale, type) {\n      for (let i = 0; i < values.length; i++) {\n        if (locale === values[i].language && type === values[i].type) {\n          return values[i].value;\n        }\n      }\n      \n      return null;\n    }\n    \n    appendResult(result) {\n      const resultContainer = $('<div>').addClass('mce-kunta-api-search-result-row');\n      const name = this.getLocalizedValueAndType(result.names, this.displayLocale, 'Name');\n\n      resultContainer.append(\n        $('<p>')\n          .addClass('mce-kunta-api-search-result-title')\n          .text(name)\n      );\n      \n      Object.keys(SUPPORTED_COMPONENTS).forEach((component) => {\n        const options = SUPPORTED_COMPONENTS[component]; \n        resultContainer.append(\n          $('<p>')\n            .append($('<input>')\n            .addClass('service-component-embed-input')\n            .attr({\n              'type':'checkbox',\n              'data-service-location-channel-name': name,\n              'data-component-type': component,\n              'data-service-location-channel-id': result.id\n            }))\n            .append($('<span>').text(options.title))\n        );\n      });\n      \n      $('.mce-kunta-api-search-results').append(resultContainer);\n    }\n    \n    handleResponse(response) {\n      $('.mce-kunta-api-search-results').empty();\n\n      if (response.length === 0) {\n        $('.mce-kunta-api-search-info').text('Hakusanalla ei löytynyt yhtään palvelua');\n      } else {\n        $('.mce-kunta-api-search-info').text('Kirjoita hakusana yllä olevaan hakukenttään');\n      }\n\n      for (let i = 0; i < response.length; i++) {\n        this.appendResult(response[i]);\n      }\n\n    }\n    \n  }\n  \n  tinymce.PluginManager.add('kunta_api_service_location_embed', (editor, url) => {\n    new ServiceLocationServiceChannelEmbed(editor);\n    new ServiceLocationServiceChannelEditor(editor);\n  });\n  \n})(tinymce, jQuery);"]}