{"version":3,"sources":["../src/kunta-api-service-location-channel-embed/js/plugin.js"],"names":["tinymce","$","SUPPORTED_COMPONENTS","AbstractEditor","dialog","tab","localized","locale","i","length","language","value","values","LocalizedValueEditor","name","title","multiline","getLocalizedValue","label","type","targetList","newValue","valueUpdated","forEach","targetItem","index","splice","newItem","push","ServiceLocationServiceChannelNameEditor","serviceLocationServiceChannel","names","AbstractServiceLocationServiceChannelDescriptionEditor","descriptionType","descriptions","filter","description","ServiceLocationServiceChannelShortDescriptionEditor","ServiceLocationServiceChannelDescriptionEditor","ServiceLocationServiceChannelAbstractMultivalueEditor","supportedLocales","options","on","onDialogOpen","bind","createFieldList","createFieldSets","createAddButton","items","layout","id","baseName","columns","getValues","map","createFieldSet","classes","text","addButtonText","window","find","onAddAddressClick","event","addChildItems","ServiceLocationServiceChannelAddressEditor","addresses","border","createAddressFields","address","additionalInformation","streetNumber","postalCode","result","getStreetAddressFieldName","streetAddress","getAdditionalInformationFieldName","getStreetNumberFieldName","getPostalCodeFieldName","additionalInformations","commitLocalizedValue","ServiceLocationServiceChannelDialog","editor","dialogTitle","listeners","editors","selector","container","append","create","tabEditors","tabItems","concat","getEditorFields","callback","post","ajaxurl","JSON","stringify","response","fail","responseText","statusText","tabs","contactSubtabs","createTab","windowManager","open","body","width","height","buttons","subtype","onclick","dialogForm","form","settings","toJSON","commitValue","saveServiceLocationServiceChannel","err","tinyMCE","activeEditor","alert","close","trigger","data","listener","callable","ServiceLocationServiceChannelEditor","buttonStyle","onBeforeSetcontent","onGetContent","onDblClick","addCommand","onServiceLocationChannelEdit","string","re","match","exec","content","replace","all","tag","attributesText","end","attributes","parseAttributes","placeholder","attr","css","attribute","component","getComponentTitle","html","input","shortcodeAttributes","attributeNames","attributeName","attributeValue","join","element","placeholderAttr","serviceLocationServiceChannelId","execCommand","parse","replaceShortcodes","restoreShortcodes","target","openElementEditor","ui","findServiceLocationServiceChannel","console","log","ServiceLocationServiceChannelEmbed","displayLocale","searching","pending","addButton","onKeyUp","e","searchServiceLocationChannels","innerResponse","handleResponse","minHeight","onsubmit","responseHtml","allEmbedsFromSameChannel","componentsToEmbed","firstServiceLocationChannelId","first","serviceLocationChannelName","each","serviceLocationChannelId","confirm","confirmed","pageId","val","markAsServiceLocationPage","insertContent","query","empty","addClass","remove","resultContainer","getLocalizedValueAndType","Object","keys","appendResult","PluginManager","add","url","jQuery"],"mappings":"8tDAAA,6BACA,CAAC,SAACA,OAAD,CAAUC,CAAV,CAAgB,CAEf,GAAMC,sBAAuB,CAC3B,OAAQ,CACN,QAAS,qBADH,CADmB,CAI3B,cAAe,CACb,QAAS,uBADI,CAJY,CAO3B,QAAS,CACP,QAAS,0CADF,CAPkB,CAU3B,YAAa,CACX,QAAS,6BADE,CAVc,CAa3B,MAAO,CACL,QAAS,sBADJ,CAboB,CAgB3B,QAAS,CACP,QAAS,+BADF,CAhBkB,CAmB3B,eAAgB,CACd,QAAS,4BADK,CAnBW,CAsB3B,WAAY,CACV,QAAS,+BADC,CAtBe,CAA7B,CAFe,GA6BTC,eA7BS,YA+Bb,wBAAYC,MAAZ,CAAoBC,GAApB,CAAyB,sCACvB,KAAKD,MAAL,CAAcA,MAAd,CACA,KAAKC,GAAL,CAAWA,GACZ,CAlCY,uFAoCKC,SApCL,CAoCgBC,MApChB,CAoCwB,CACnC,IAAK,GAAIC,GAAI,CAAb,CAAgBA,EAAIF,UAAUG,MAA9B,CAAsCD,GAAtC,CAA2C,CACzC,GAAIF,UAAUE,CAAV,EAAaE,QAAb,GAA0BH,MAA9B,CAAsC,CACpC,MAAOD,WAAUE,CAAV,EAAaG,KACrB,CACF,CAED,MAAO,KACR,CA5CY,gDA8CDJ,MA9CC,CA8COK,MA9CP,CA8Ce,CAC3B,CA/CY,gCAmDTC,qBAnDS,2EAqDb,8BAAYT,MAAZ,CAAoBC,GAApB,CAAyBE,MAAzB,CAAiCO,IAAjC,CAAuCC,KAAvC,CAA8CC,SAA9C,CAAyD,8KACjDZ,MADiD,CACzCC,GADyC,GAEvD,MAAKE,MAAL,CAAcA,MAAd,CACA,MAAKO,IAAL,CAAYA,IAAZ,CACA,MAAKC,KAAL,CAAaA,KAAb,CACA,MAAKC,SAAL,CAAiBA,SAAjB,CALuD,YAMxD,CA3DY,yFA6DGJ,MA7DH,CA6DW,CACtB,GAAMD,OAAQ,KAAKM,iBAAL,CAAuBL,MAAvB,CAA+B,KAAKL,MAApC,CAAd,CACA,MAAO,CAAC,CACNO,KAAS,KAAKA,IAAd,KAAsB,KAAKP,MADrB,CAENW,MAAU,KAAKH,KAAf,MAAyB,KAAKR,MAA9B,IAFM,CAGNY,KAAM,SAHA,CAINH,UAAW,KAAKA,SAJV,CAKNL,MAAOA,KALD,CAAD,CAOR,CAtEY,kEAwEQS,UAxER,CAwEoBR,MAxEpB,CAwE4BE,IAxE5B,CAwEkCK,IAxElC,CAwEwC,iBACnD,GAAME,UAAWT,OAAUE,IAAV,KAAkB,KAAKP,MAAvB,CAAjB,CACA,GAAIe,cAAe,KAAnB,CAEAF,WAAWG,OAAX,CAAmB,SAACC,UAAD,CAAaC,KAAb,CAAuB,CACxC,GAAID,WAAWd,QAAX,GAAwB,OAAKH,MAA7B,GAAwC,CAACY,IAAD,EAASA,OAASK,WAAWL,IAArE,CAAJ,CAAgF,CAC9E,GAAIE,QAAJ,CAAc,CACZG,WAAWb,KAAX,CAAmBU,QACpB,CAFD,IAEO,CACLD,WAAWM,MAAX,CAAkBD,KAAlB,CAAyB,CAAzB,CACD,CAEDH,aAAe,IAChB,CACF,CAVD,EAYA,GAAID,UAAY,CAACC,YAAjB,CAA+B,CAC7B,GAAMK,SAAU,CACdhB,MAAOU,QADO,CAEdX,SAAU,KAAKH,MAFD,CAAhB,CAKA,GAAIY,IAAJ,CAAU,CACRQ,QAAQR,IAAR,CAAeA,IAChB,CAEDC,WAAWQ,IAAX,CAAgBD,OAAhB,CACD,CACF,CApGY,iCAmDoBxB,cAnDpB,EAsGd,CAtGc,GAwGT0B,wCAxGS,0GA0Gb,iDAAYzB,MAAZ,CAAoBC,GAApB,CAAyBE,MAAzB,CAAiCuB,6BAAjC,CAAgE,wOACxD1B,MADwD,CAChDC,GADgD,CAC3CE,MAD2C,CACnC,MADmC,CAC3B,MAD2B,CACnB,KADmB,GAE9D,OAAKuB,6BAAL,CAAqCA,6BAArC,CAF8D,aAG/D,CA7GY,6GA+GK,CAChB,oLAA6B,KAAKA,6BAAL,CAAmCC,KAAhE,CACD,CAjHY,gDAmHDnB,MAnHC,CAmHO,CAClB,kLAA2B,KAAKkB,6BAAL,CAAmCC,KAA9D,CAAqEnB,MAArE,CAA6E,MAA7E,CACD,CArHY,oDAwGuCC,oBAxGvC,EAuHd,CAvHc,GAyHTmB,uDAzHS,2HA2Hb,gEAAY5B,MAAZ,CAAoBC,GAApB,CAAyBE,MAAzB,CAAiCO,IAAjC,CAAuCC,KAAvC,CAA8CkB,eAA9C,CAA+DH,6BAA/D,CAA8F,qRACtF1B,MADsF,CAC9EC,GAD8E,CACzEE,MADyE,CACjEO,IADiE,CAC3DC,KAD2D,CACpD,IADoD,GAE5F,OAAKe,6BAAL,CAAqCA,6BAArC,CACA,OAAKG,eAAL,CAAuBA,eAAvB,CAH4F,aAI7F,CA/HY,4HAiIK,iBAChB,kNAA6B,KAAKH,6BAAL,CAAmCI,YAAnC,CAAgDC,MAAhD,CAAuD,SAACC,WAAD,CAAiB,CACnG,MAAOA,aAAYjB,IAAZ,GAAqB,OAAKc,eAClC,CAF4B,CAA7B,CAGD,CArIY,mEAyHsDpB,oBAzHtD,EAuId,CAvIc,GAyITwB,oDAzIS,sHA2IZ,6DAAYjC,MAAZ,CAAoBC,GAApB,CAAyBE,MAAzB,CAAiCuB,6BAAjC,CAAgE,4QACzD1B,MADyD,CACjDC,GADiD,CAC5CE,MAD4C,CACpC,mBADoC,CACf,gBADe,CACA,kBADA,GAE/D,OAAKuB,6BAAL,CAAqCA,6BAArC,CAF+D,aAGhE,CA9IY,gHAgJDlB,MAhJC,CAgJO,CAClB,0MAA2B,KAAKkB,6BAAL,CAAmCI,YAA9D,CAA4EtB,MAA5E,CAAoF,mBAApF,CAAyG,kBAAzG,CACD,CAlJY,gEAyImDoB,sDAzInD,EAoJd,CApJc,GAsJTM,+CAtJS,mHAwJb,wDAAYlC,MAAZ,CAAoBC,GAApB,CAAyBE,MAAzB,CAAiCuB,6BAAjC,CAAgE,6PAC1D1B,MAD0D,CAClDC,GADkD,CAC7CE,MAD6C,CACrC,aADqC,CACtB,QADsB,CACZ,aADY,GAE9D,OAAKuB,6BAAL,CAAqCA,6BAArC,CAF8D,aAG/D,CA3JY,2GA6JDlB,MA7JC,CA6JO,CAClB,gMAA2B,KAAKkB,6BAAL,CAAmCI,YAA9D,CAA4EtB,MAA5E,CAAoF,aAApF,CAAmG,aAAnG,CACD,CA/JY,2DAsJ8CoB,sDAtJ9C,EAiKd,CAjKc,GAmKTO,sDAnKS,8GAqKb,+DAAYnC,MAAZ,CAAoBC,GAApB,CAAyBmC,gBAAzB,CAA2CV,6BAA3C,CAA0EW,OAA1E,CAAmF,kRAC3ErC,MAD2E,CACnEC,GADmE,GAEjF,OAAKoC,OAAL,CAAeA,OAAf,CACA,OAAKhB,KAAL,CAAa,CAAC,CAAd,CACA,OAAKK,6BAAL,CAAqCA,6BAArC,CACA,OAAKU,gBAAL,CAAwBA,gBAAxB,CACA,OAAKpC,MAAL,CAAYsC,EAAZ,CAAe,MAAf,CAAuB,OAAKC,YAAL,CAAkBC,IAAlB,QAAvB,EANiF,aAOlF,CA5KY,+GA8KD,CACV,MAAO,EACR,CAhLY,yDAkLK,CAChB,MAAO,CACL,KAAKC,eAAL,CAAqB,KAAKC,eAAL,EAArB,CADK,CAEL,KAAKC,eAAL,EAFK,CAIR,CAvLY,wDAyLGC,KAzLH,CAyLU,CACrB,MAAO,CACL9B,MAAO,EADF,CAELC,KAAM,WAFD,CAGL8B,OAAQ,MAHH,CAILC,GAAO,KAAKT,OAAL,CAAaU,QAApB,QAJK,CAKLrC,KAAS,KAAK2B,OAAL,CAAaU,QAAtB,QALK,CAMLC,QAAS,CANJ,CAOLJ,MAAOA,KAPF,CASR,CAnMY,yDAqMK,iBAChB,MAAO,MAAKK,SAAL,GAAiBC,GAAjB,CAAqB,SAAC3C,KAAD,CAAW,CACrC,MAAO,QAAK4C,cAAL,CAAoB5C,KAApB,CACR,CAFM,CAGR,CAzMY,yDA2MK,CAChB,MAAO,CACLuC,GAAO,KAAKT,OAAL,CAAaU,QAApB,OADK,CAELK,QAAY,KAAKf,OAAL,CAAaU,QAAzB,OAFK,CAGLrC,KAAS,KAAK2B,OAAL,CAAaU,QAAtB,OAHK,CAILhC,KAAM,QAJD,CAKLsC,KAAM,KAAKhB,OAAL,CAAaiB,aALd,CAOR,CAnNY,kEAqNQtC,UArNR,CAqNoBR,MArNpB,CAqN4BE,IArN5B,CAqNkCP,MArNlC,CAqN0C,CACrD,GAAMc,UAAWT,OAAOE,IAAP,CAAjB,CACA,GAAIQ,cAAe,KAAnB,CAEAF,WAAWG,OAAX,CAAmB,SAACC,UAAD,CAAaC,KAAb,CAAuB,CACxC,GAAID,WAAWd,QAAX,GAAwBH,MAA5B,CAAoC,CAClC,GAAIc,QAAJ,CAAc,CACZG,WAAWb,KAAX,CAAmBU,QACpB,CAFD,IAEO,CACLD,WAAWM,MAAX,CAAkBD,KAAlB,CAAyB,CAAzB,CACD,CAEDH,aAAe,IAChB,CACF,CAVD,EAYA,GAAID,UAAY,CAACC,YAAjB,CAA+B,CAC7BF,WAAWQ,IAAX,CAAgB,CACdjB,MAAOU,QADO,CAEdX,SAAUH,MAFI,CAAhB,CAID,CACF,CA3OY,mDA6OE,CACb,KAAKH,MAAL,CAAYuD,MAAZ,CAAmBC,IAAnB,KAA4B,KAAKnB,OAAL,CAAaU,QAAzC,SAAyDT,EAAzD,CAA4D,OAA5D,CAAqE,KAAKmB,iBAAL,CAAuBjB,IAAvB,CAA4B,IAA5B,CAArE,CACD,CA/OY,4DAiPKkB,KAjPL,CAiPY,CACvB,KAAK1D,MAAL,CAAY2D,aAAZ,KAA8B,KAAKtB,OAAL,CAAaU,QAA3C,SAA4D,KAAKI,cAAL,EAA5D,CACD,CAnPY,kEAmKqDpD,cAnKrD,EAqPd,CArPc,GAuPT6D,2CAvPS,6GAyPb,oDAAY5D,MAAZ,CAAoBC,GAApB,CAAyBmC,gBAAzB,CAA2CV,6BAA3C,CAA0E,6OAClE1B,MADkE,CAC1DC,GAD0D,CACrDmC,gBADqD,CACnCV,6BADmC,CACJ,CAClEqB,SAAU,SADwD,CAElEO,cAAe,oBAFmD,CADI,EAKzE,CA9PY,oGAgQD,CACV,MAAO,MAAK5B,6BAAL,CAAmCmC,SAC3C,CAlQY,sDAoQEtD,KApQF,CAoQS,CACpB,MAAO,CACLO,MAAO,QADF,CAELC,KAAM,UAFD,CAGL+C,OAAQ,MAHH,CAILjB,OAAQ,MAJH,CAKLnC,KAAM,SALD,CAMLsC,QAAS,CANJ,CAOLJ,MAAO,KAAKmB,mBAAL,CAAyBxD,KAAzB,CAPF,CASR,CA9QY,gEAgROyD,OAhRP,CAgRgB,kBAC3B,GAAMC,uBAAwB,IAA9B,CACA,GAAMC,cAAeF,QAAUA,QAAQE,YAAlB,CAAiC,IAAtD,CACA,GAAMC,YAAaH,QAAUA,QAAQG,UAAlB,CAA+B,IAAlD,CACA,KAAK9C,KAAL,GAEA,GAAM+C,QAAS,EAAf,CAEA,KAAKhC,gBAAL,CAAsBjB,OAAtB,CAA8B,SAAChB,MAAD,CAAY,CACxCiE,OAAO5C,IAAP,CAAY,CACV,OAAQ,QAAK6C,yBAAL,CAA+BlE,MAA/B,CAAuC,QAAKkB,KAA5C,CADE,CAEV,OAAQ,SAFE,CAGV,sBAAuBlB,MAAvB,IAHU,CAIV,QAAS6D,QAAU,QAAKnD,iBAAL,CAAuBmD,QAAQM,aAA/B,CAA8CnE,MAA9C,CAAV,CAAkE,IAJjE,CAAZ,EAOAiE,OAAO5C,IAAP,CAAY,CACV,OAAQ,QAAK+C,iCAAL,CAAuCpE,MAAvC,CAA+C,QAAKkB,KAApD,CADE,CAEV,OAAQ,SAFE,CAGV,mCAAiClB,MAAjC,IAHU,CAIV,QAAS8D,sBAAwBA,sBAAsB1D,KAA9C,CAAsD,EAJrD,CAAZ,CAMD,CAdD,EAgBA6D,OAAO5C,IAAP,CAAY,CACV,OAAQ,KAAKgD,wBAAL,CAA8B,KAAKnD,KAAnC,CADE,CAEV,OAAQ,SAFE,CAGV,QAAS,cAHC,CAIV,QAAS6C,YAJC,CAAZ,EAOAE,OAAO5C,IAAP,CAAY,CACV,OAAQ,KAAKiD,sBAAL,CAA4B,KAAKpD,KAAjC,CADE,CAEV,OAAQ,SAFE,CAGV,QAAS,aAHC,CAIV,QAAS8C,UAJC,CAAZ,EAOA,MAAOC,OACR,CAvTY,gDAyTD5D,MAzTC,CAyTO,2CACTa,KADS,EAEhB,GAAI2C,SAAU,QAAKtC,6BAAL,CAAmCmC,SAAnC,CAA6CxC,KAA7C,CAAd,CACA,GAAI,CAAC2C,OAAL,CAAc,CACZA,QAAU,EAAV,CACA,QAAKtC,6BAAL,CAAmCmC,SAAnC,CAA6CrC,IAA7C,CAAkDwC,OAAlD,CACD,CAED,GAAI,CAACA,QAAQM,aAAb,CAA4B,CAC1BN,QAAQM,aAAR,CAAwB,EACzB,CAED,GAAI,CAACN,QAAQU,sBAAb,CAAqC,CACnCV,QAAQU,sBAAR,CAAiC,EAClC,CAED,QAAKtC,gBAAL,CAAsBjB,OAAtB,CAA8B,SAAChB,MAAD,CAAY,CACxC,QAAKwE,oBAAL,CAA0BX,QAAQM,aAAlC,CAAiD9D,MAAjD,CAAyD,QAAK6D,yBAAL,CAA+BlE,MAA/B,CAAuCkB,KAAvC,CAAzD,CAAwGlB,MAAxG,EACA,QAAKwE,oBAAL,CAA0BX,QAAQU,sBAAlC,CAA0DlE,MAA1D,CAAkE,QAAK+D,iCAAL,CAAuCpE,MAAvC,CAA+CkB,KAA/C,CAAlE,CAAyHlB,MAAzH,CACD,CAHD,EAKA6D,QAAQE,YAAR,CAAuB1D,OAAO,QAAKgE,wBAAL,CAA8BnD,KAA9B,CAAP,CAAvB,CACA2C,QAAQG,UAAR,CAAqB3D,OAAO,QAAKiE,sBAAL,CAA4BpD,KAA5B,CAAP,CAtBL,EAClB,IAAK,GAAIA,OAAQ,CAAjB,CAAoBA,MAAQ,KAAKA,KAAL,CAAa,CAAzC,CAA4CA,OAA5C,CAAqD,OAA5CA,KAA4C,CAsBpD,CACF,CAjVY,4EAmValB,MAnVb,CAmVqBkB,KAnVrB,CAmV4B,CACvC,gCAAiClB,MAAjC,KAA2CkB,KAC5C,CArVY,0EAuVYA,KAvVZ,CAuVmB,CAC9B,+BAAgCA,KACjC,CAzVY,sEA2VUA,KA3VV,CA2ViB,CAC5B,6BAA8BA,KAC/B,CA7VY,4FA+VqBlB,MA/VrB,CA+V6BkB,KA/V7B,CA+VoC,CAC/C,wCAAyClB,MAAzC,KAAmDkB,KACpD,CAjWY,uDAuP0Cc,qDAvP1C,EAmWd,CAnWc,GAqWTyC,oCArWS,YAuWb,6CAAYC,MAAZ,CAAoBnD,6BAApB,CAAmD,4EACjD,KAAKA,6BAAL,CAAqCA,6BAArC,CACA,KAAKoD,WAAL,CAAmB,cAAnB,CACA,KAAK1C,gBAAL,CAAwB,CAAC,IAAD,CAAO,IAAP,CAAa,IAAb,CAAxB,CACA,KAAKyC,MAAL,CAAcA,MAAd,CACA,KAAKE,SAAL,CAAiB,EAAjB,CACA,KAAKC,OAAL,CAAe,EAAf,CAEA,KAAK5C,gBAAL,CAAsBjB,OAAtB,CAA8B,SAAChB,MAAD,CAAY,CACxC,QAAK6E,OAAL,CAAaxD,IAAb,CAAkB,GAAIC,wCAAJ,kBAA2DtB,MAA3D,CAAqEA,MAArE,CAA6EuB,6BAA7E,CAAlB,EACA,QAAKsD,OAAL,CAAaxD,IAAb,CAAkB,GAAIS,oDAAJ,kBAAuE9B,MAAvE,CAAiFA,MAAjF,CAAyFuB,6BAAzF,CAAlB,EACA,QAAKsD,OAAL,CAAaxD,IAAb,CAAkB,GAAIU,+CAAJ,kBAAkE/B,MAAlE,CAA4EA,MAA5E,CAAoFuB,6BAApF,CAAlB,CACD,CAJD,EAMA,KAAKsD,OAAL,CAAaxD,IAAb,CAAkB,GAAIoC,2CAAJ,CAA+C,IAA/C,CAAqD,WAArD,CAAkE,KAAKxB,gBAAvE,CAAyFV,6BAAzF,CAAlB,EAEA;AACD,CAxXY,oGA0XCuD,QA1XD,CA0XWrC,KA1XX,CA0XkB,CAC7B,GAAMsC,WAAY,KAAK3B,MAAL,CAAYC,IAAZ,CAAiByB,QAAjB,EAA2B,CAA3B,CAAlB,CACAC,UAAUC,MAAV,CAAiBD,UAAUE,MAAV,CAAiBxC,KAAjB,CAAjB,CACD,CA7XY,oDA+XCzC,MA/XD,CA+XS,CACpB,OAAQA,MAAR,EACE,IAAK,IAAL,CACE,MAAO,OAAP,CACF,IAAK,IAAL,CACE,MAAO,UAAP,CACF,IAAK,IAAL,CACE,MAAO,QAAP,CANJ,CAQD,CAxYY,4CA0YHO,IA1YG,CA0YGC,KA1YH,CA0YUiC,KA1YV,CA0YiB,CAC5B,GAAMyC,YAAa,KAAKL,OAAL,CAAajD,MAAb,CAAoB,SAAC8C,MAAD,CAAY,CACjD,MAAOA,QAAO5E,GAAP,GAAeS,IACvB,CAFkB,CAAnB,CAIA,GAAI4E,UAAW,EAAf,CAEA,GAAI1C,KAAJ,CAAW,CACT0C,SAAW1C,KACZ,CAFD,IAEO,CACLyC,WAAWlE,OAAX,CAAmB,SAAC0D,MAAD,CAAY,CAC7BS,SAAWA,SAASC,MAAT,CAAgBV,OAAOW,eAAP,EAAhB,CACZ,CAFD,CAGD,CAED,MAAO,CACLzE,KAAM,UADD,CAELL,KAAMA,IAFD,CAGLC,MAAOA,KAHF,CAILiC,MAAO0C,QAJF,CAMR,CA/ZY,4FAiaqB5D,6BAjarB,CAiaoD+D,QAjapD,CAia8D,CACzE5F,EAAE6F,IAAF,CAAOC,OAAP,CAAgB,CACd,SAAU,iDADI,CAEd,gCAAiCC,KAAKC,SAAL,CAAe,KAAKnE,6BAApB,CAFnB,CAAhB,CAGG,SAACoE,QAAD,CAAc,CACfL,UACD,CALD,EAMCM,IAND,CAMM,SAACD,QAAD,CAAc,CAClBL,SAASK,SAASE,YAAT,EAAyBF,SAASG,UAA3C,CACD,CARD,CASD,CA3aY,mCA6aN,kBACL,GAAIC,MAAO,EAAX,CACA,GAAMC,gBAAiB,EAAvB,CAEAA,eAAe3E,IAAf,CAAoB,KAAK4E,SAAL,CAAe,QAAf,CAAyB,mBAAzB,CAApB,EACAD,eAAe3E,IAAf,CAAoB,KAAK4E,SAAL,CAAe,KAAf,CAAsB,QAAtB,CAApB,EACAD,eAAe3E,IAAf,CAAoB,KAAK4E,SAAL,CAAe,OAAf,CAAwB,WAAxB,CAApB,EACAD,eAAe3E,IAAf,CAAoB,KAAK4E,SAAL,CAAe,KAAf,CAAsB,aAAtB,CAApB,EAEAF,KAAK1E,IAAL,CAAU,KAAK4E,SAAL,CAAe,QAAf,CAAyB,SAAzB,CAAV,EAEA,KAAKhE,gBAAL,CAAsBjB,OAAtB,CAA8B,SAAChB,MAAD,CAAY,CACxC+F,KAAK1E,IAAL,CAAU,QAAK4E,SAAL,UAAwBjG,MAAxB,iBAAkDA,MAAlD,KAAV,CACD,CAFD,EAIA+F,KAAK1E,IAAL,CAAU,KAAK4E,SAAL,CAAe,WAAf,CAA4B,WAA5B,CAAV,EACAF,KAAK1E,IAAL,CAAU,KAAK4E,SAAL,CAAe,OAAf,CAAwB,aAAxB,CAAV,EACAF,KAAK1E,IAAL,CAAU,KAAK4E,SAAL,CAAe,UAAf,CAA2B,cAA3B,CAA2CD,cAA3C,CAAV,EAEA,KAAK5C,MAAL,CAAc,KAAKsB,MAAL,CAAYwB,aAAZ,CAA0BC,IAA1B,CAA+B,CAC3C3F,MAAO,KAAKmE,WAD+B,CAE3CyB,KAAM,CAAC,CACLzD,GAAI,aADC,CAEL/B,KAAM,MAFD,CAGL6B,MAAO,CAAC,CACNlC,KAAM,SADA,CAENK,KAAM,UAFA,CAGN8B,OAAQ,KAHF,CAIND,MAAOsD,IAJD,CAAD,CAHF,CAAD,CAFqC,CAY3CM,MAAO,IAZoC,CAa3CC,OAAQ,GAbmC,CAc3CC,QAAS,CAAC,CACRrD,KAAM,UADE,CAERsD,QAAS,MAFD,CAGRC,QAAS,iBAAClD,KAAD,CAAW,CAClB,GAAMmD,YAAa,QAAKtD,MAAL,CAAYC,IAAZ,CAAiB,MAAjB,EAAyBzB,MAAzB,CAAgC,SAAC+E,IAAD,CAAU,CAC3D,MAAOA,MAAKC,QAAL,CAAcjE,EAAd,GAAqB,aAC7B,CAFkB,EAEhB,CAFgB,CAAnB,CAIA,GAAMtC,QAASqG,WAAWG,MAAX,EAAf,CACA,QAAKhC,OAAL,CAAa7D,OAAb,CAAqB,SAAC0D,MAAD,CAAY,CAC/BA,OAAOoC,WAAP,CAAmBzG,MAAnB,CACD,CAFD,EAIA,QAAK0G,iCAAL,CAAuC,QAAKxF,6BAA5C,CAA2E,SAACyF,GAAD,CAAS,CAClF,GAAIA,GAAJ,CAAS,CACPC,QAAQC,YAAR,CAAqBhB,aAArB,CAAmCiB,KAAnC,CAAyCH,GAAzC,CACD,CACF,CAJD,CAKD,CAlBO,CAAD,CAmBN,CACD9D,KAAM,SADL,CAEDuD,QAAS,kBAAM,CACb,QAAKrD,MAAL,CAAYgE,KAAZ,EACD,CAJA,CAnBM,CAdkC,CAA/B,CAAd,CAyCA,KAAKC,OAAL,CAAa,MAAb,CACD,CA1eY,wCA4eJ9D,KA5eI,CA4eG+D,IA5eH,CA4eS,CACpB,KAAK1C,SAAL,CAAe5D,OAAf,CAAuB,SAACuG,QAAD,CAAc,CACnC,GAAIA,SAAShE,KAAT,GAAmBA,KAAvB,CAA8B,CAC5BgE,SAASC,QAAT,CAAkBF,MAAM,EAAxB,CACD,CACF,CAJD,CAKD,CAlfY,8BAofT/D,KApfS,CAofFiE,QApfE,CAofQ,CACnB,KAAK5C,SAAL,CAAevD,IAAf,CAAoB,CAClBkC,MAAOA,KADW,CAElBiE,SAAUA,QAFQ,CAApB,CAID,CAzfY,qDA6fTC,oCA7fS,YA+fb,6CAAa/C,MAAb,CAAqB,2DACnB,KAAKgD,WAAL,CAAmB,CACjB,QAAS,MADQ,CAEjB,QAAS,MAFQ,CAGjB,SAAU,gBAHO,CAIjB,aAAc,SAJG,CAKjB,UAAW,OALM,CAMjB,UAAW,KANM,CAOjB,aAAc,KAPG,CAQjB,gBAAiB,KARA,CASjB,SAAU,SATO,CAAnB,CAYA,KAAKhD,MAAL,CAAcA,MAAd,CAEA,KAAKA,MAAL,CAAYvC,EAAZ,CAAe,kBAAf,CAAmC,KAAKwF,kBAAL,CAAwBtF,IAAxB,CAA6B,IAA7B,CAAnC,EACA,KAAKqC,MAAL,CAAYvC,EAAZ,CAAe,YAAf,CAA6B,KAAKyF,YAAL,CAAkBvF,IAAlB,CAAuB,IAAvB,CAA7B,EACA,KAAKqC,MAAL,CAAYvC,EAAZ,CAAe,UAAf,CAA2B,KAAK0F,UAAL,CAAgBxF,IAAhB,CAAqB,IAArB,CAA3B,EACA,KAAKqC,MAAL,CAAYoD,UAAZ,CAAuB,yCAAvB,CAAkE,KAAKC,4BAAL,CAAkC1F,IAAlC,CAAuC,IAAvC,CAAlE,CACD,CAlhBY,wGAohBI2F,MAphBJ,CAohBY,CACvB,GAAM/D,QAAS,EAAf,CACA,GAAMgE,IAAK,yCAAX,CACA,GAAIC,OAAQ,IAAZ,CAEA,EAAG,CACDA,MAAQD,GAAGE,IAAH,CAAQH,MAAR,CAAR,CACA,GAAIE,OAASA,MAAMhI,MAAN,CAAe,CAA5B,CAA+B,CAC7B+D,OAAO5C,IAAP,CAAY,CACVd,KAAM2H,MAAM,CAAN,CADI,CAEV9H,MAAO8H,MAAM,CAAN,CAFG,CAAZ,CAID,CACF,CARD,MAQSA,KART,EAUA,MAAOjE,OACR,CApiBY,4DAsiBM1D,IAtiBN,CAsiBY,CACvB,MAAOZ,sBAAqBY,IAArB,EAA2BC,KACnC,CAxiBY,4DA0iBK4H,OA1iBL,CA0iBc,kBACzB,MAAOA,SAAQC,OAAR,CAAgB,gEAAhB,CAAkF,SAACC,GAAD,CAAMC,GAAN,CAAWC,cAAX,CAA2BC,GAA3B,CAAmC,CAC1H,GAAMC,YAAa,QAAKC,eAAL,CAAqBH,cAArB,CAAnB,CACA,GAAMI,aAAclJ,EAAE,SAAF,EACjBmJ,IADiB,CACZ,CACL,OAAQ,QADH,CAEL,6BAA8B,4BAFzB,CADY,EAKjBC,GALiB,CAKb,QAAKpB,WALQ,CAApB,CAOA,IAAK,GAAIzH,GAAI,CAAb,CAAgBA,EAAIyI,WAAWxI,MAA/B,CAAuCD,GAAvC,CAA4C,CAC1C,GAAM8I,WAAYL,WAAWzI,CAAX,CAAlB,CACA2I,YAAYC,IAAZ,CAAiB,QAAUE,UAAUxI,IAArC,CAA2CwI,UAAU3I,KAArD,CACD,CAED,GAAM4I,WAAYJ,YAAYC,IAAZ,CAAiB,gBAAjB,CAAlB,CACA,GAAI,CAAClJ,qBAAqBqJ,SAArB,CAAL,CAAsC,CACpC,MAAOV,IACR,CAEDM,YAAYC,IAAZ,CAAiB,OAAjB,CAA0B,QAAKI,iBAAL,CAAuBD,SAAvB,CAA1B,EACA,MAAOtJ,GAAE,OAAF,EAAWsF,MAAX,CAAkB4D,WAAlB,EAA+BM,IAA/B,EACR,CArBM,CAuBR,CAlkBY,4DAokBKd,OApkBL,CAokBc,CACzB,MAAOA,SAAQC,OAAR,CAAgB,gBAAhB,CAAkC,SAACH,KAAD,CAAW,CAClD,GAAMiB,OAAQzJ,EAAEwI,KAAF,CAAd,CAEA,GAAIiB,MAAMN,IAAN,CAAW,4BAAX,IAA6C,4BAAjD,CAA+E,CAC7E,GAAMO,qBAAsB,EAA5B,CACA,GAAMC,gBAAiB,CAAC,YAAD,CAAe,WAAf,CAAvB,CAEA,IAAK,GAAIpJ,GAAI,CAAb,CAAgBA,EAAIoJ,eAAenJ,MAAnC,CAA2CD,GAA3C,CAAgD,CAC9C,GAAMqJ,eAAgBD,eAAepJ,CAAf,CAAtB,CACA,GAAMsJ,gBAAiBJ,MAAMN,IAAN,CAAW,QAAUS,aAArB,CAAvB,CACAF,oBAAoB/H,IAApB,CAAyB,CAACiI,aAAD,CAAgB,IAAMC,cAAN,CAAuB,GAAvC,EAA4CC,IAA5C,CAAiD,GAAjD,CAAzB,CACD,CAED,MAAO,yCAA2CJ,oBAAoBI,IAApB,CAAyB,GAAzB,CAA3C,CAA2E,GACnF,CAED,MAAOtB,MACR,CAjBM,CAkBR,CAvlBY,4DAylBKuB,OAzlBL,CAylBc,CACzB,GAAMC,iBAAkBD,QAAQf,UAAR,CAAmB,4BAAnB,CAAxB,CACA,GAAIgB,eAAJ,CAAqB,CACnB,GAAMC,iCAAkCF,QAAQf,UAAR,CAAmB,iBAAnB,EAAsCtI,KAA9E,CACA,KAAKsE,MAAL,CAAYkF,WAAZ,CAAwB,yCAAxB,CAAmE,EAAnE,CAAuE,CACrED,gCAAiCA,+BADoC,CAAvE,CAGD,CACF,CAjmBY,4FAmmBqBhH,EAnmBrB,CAmmByB2C,QAnmBzB,CAmmBmC,CAC9C5F,EAAE6F,IAAF,CAAOC,OAAP,CAAgB,CACd,SAAU,iDADI,CAEd,kCAAmC7C,EAFrB,CAAhB,CAGG,SAACgD,QAAD,CAAc,CACfL,SAAS,IAAT,CAAeG,KAAKoE,KAAL,CAAWlE,QAAX,CAAf,CACD,CALD,EAMCC,IAND,CAMM,SAACD,QAAD,CAAc,CAClBL,SAASK,SAASE,YAAT,EAAyBF,SAASG,UAA3C,CACD,CARD,CASD,CA7mBY,8DA+mBMvC,KA/mBN,CA+mBa,CACxBA,MAAM6E,OAAN,CAAgB,KAAK0B,iBAAL,CAAuBvG,MAAM6E,OAA7B,CACjB,CAjnBY,kDAmnBA7E,KAnnBA,CAmnBO,CAClBA,MAAM6E,OAAN,CAAgB,KAAK2B,iBAAL,CAAuBxG,MAAM6E,OAA7B,CACjB,CArnBY,8CAunBF7E,KAvnBE,CAunBK,CAChB,GAAMkG,SAAUlG,MAAMyG,MAAtB,CACA,KAAKC,iBAAL,CAAuBR,OAAvB,CACD,CA1nBY,kFA4nBgBS,EA5nBhB,CA4nBoBhI,OA5nBpB,CA4nB6B,kBACxC,KAAKiI,iCAAL,CAAuCjI,QAAQyH,+BAA/C,CAAgF,SAAC3C,GAAD,CAAMzF,6BAAN,CAAwC,CACtH6I,QAAQC,GAAR,CAAYrD,GAAZ,CAAiBzF,6BAAjB,EAEA,GAAIyF,GAAJ,CAAS,CACPC,QAAQC,YAAR,CAAqBhB,aAArB,CAAmCiB,KAAnC,CAAyCH,GAAzC,CACD,CAFD,IAEO,CACL,GAAMnH,QAAS,GAAI4E,oCAAJ,CAAwC,QAAKC,MAA7C,CAAqDnD,6BAArD,CAAf,CACA1B,OAAOsG,IAAP,EACD,CACF,CATD,CAUD,CAvoBY,qDA2oBTmE,mCA3oBS,YA6oBb,4CAAa5F,MAAb,CAAqB,0DACnB,KAAKA,MAAL,CAAcA,MAAd,CACA,KAAK6F,aAAL,CAAqB,IAArB,CACA,KAAKC,SAAL,CAAiB,KAAjB,CACA,KAAKC,OAAL,CAAe,KAAf,CACA,KAAKC,SAAL,EACD,CAnpBY,4FAqpBA,kBACX,KAAKhG,MAAL,CAAYgG,SAAZ,CAAsB,kCAAtB,CAA0D,CACxDlK,MAAO,4CADiD,CAExDiG,QAAS,kBAAM,CACb,QAAK/B,MAAL,CAAYwB,aAAZ,CAA0BC,IAA1B,CAA+B,CAC7B3F,MAAO,4CADsB,CAE7B6F,MAAO,GAFsB,CAG7BC,OAAQ,GAHqB,CAI7BF,KAAM,CACJ,CAAExF,KAAM,SAAR,CAAmBL,KAAM,yBAAzB,CAAoDI,MAAO,OAA3D,CAAoEgK,QAAS,iBAACC,CAAD,CAAO,CAClF,GAAI,CAAC,QAAKJ,SAAV,CAAqB,CACnB,QAAKA,SAAL,CAAiB,IAAjB,CACA,QAAKK,6BAAL,CAAmCD,EAAEZ,MAAF,CAAS5J,KAA5C,CAAmD,SAACuF,QAAD,CAAc,CAC/D,QAAK6E,SAAL,CAAiB,KAAjB,CACA,GAAI,QAAKC,OAAT,CAAkB,CAChB,QAAKI,6BAAL,CAAmCD,EAAEZ,MAAF,CAAS5J,KAA5C,CAAmD,SAAC0K,aAAD,CAAmB,CACpE,QAAKC,cAAL,CAAoBD,aAApB,CACD,CAFD,CAGD,CAJD,IAIO,CACL,QAAKC,cAAL,CAAoBpF,QAApB,CACD,CACF,CATD,CAUD,CAZD,IAYO,CACL,QAAK8E,OAAL,CAAe,IAChB,CACF,CAhBD,CADI,CAkBJ,CAAC7J,KAAM,OAAP,CAAgBqC,QAAS,uBAAzB,CAAkDC,KAAM,sDAAxD,CAlBI,CAmBJ,CAACtC,KAAM,WAAP,CAAoBqC,QAAS,0BAA7B,CAAyD+H,UAAW,GAApE,CAnBI,CAJuB,CAyB7BC,SAAU,kBAACL,CAAD,CAAO,CACf,GAAIM,cAAe,EAAnB,CACA,GAAIC,0BAA2B,IAA/B,CACA,GAAMC,mBAAoB1L,EAAE,wCAAF,CAA1B,CACA,GAAM2L,+BAAgCD,kBAAkBE,KAAlB,GAA0BzC,IAA1B,CAA+B,kCAA/B,CAAtC,CACA,GAAM0C,4BAA6BH,kBAAkBE,KAAlB,GAA0BzC,IAA1B,CAA+B,oCAA/B,CAAnC,CAEAuC,kBAAkBI,IAAlB,CAAuB,UAAY,CACjC,GAAIxC,WAAYtJ,EAAE,IAAF,EAAQmJ,IAAR,CAAa,qBAAb,CAAhB,CACA,GAAI4C,0BAA2B/L,EAAE,IAAF,EAAQmJ,IAAR,CAAa,kCAAb,CAA/B,CACAqC,cAAgB,qDAAsDO,wBAAtD,CAAgF,eAAhF,CAAiGzC,SAAjG,CAA4G,IAA5H,CACA,GAAIyC,2BAA6BJ,6BAAjC,CAAgE,CAC9DF,yBAA2B,KAC5B,CACF,CAPD,EASA,GAAIA,wBAAJ,CAA8B,CAC5B,QAAKzG,MAAL,CAAYwB,aAAZ,CAA0BwF,OAA1B,CAAkC,6CAAqCH,0BAArC,CAAkE,WAApG,CAAiH,SAASI,SAAT,CAAoB,CACnI,GAAIA,SAAJ,CAAe,CACb,GAAMC,QAASlM,EAAE,UAAF,EAAcmM,GAAd,EAAf,CACA,KAAKC,yBAAL,CAA+BT,6BAA/B,CAA8DO,MAA9D,CACD,CACF,CALD,CAMD,CAED,QAAKlH,MAAL,CAAYqH,aAAZ,CAA0Bb,YAA1B,CACD,CAnD4B,CAA/B,CAqDD,CAxDuD,CAA1D,CA0DD,CAhtBY,4EAktBaO,wBAltBb,CAktBuCG,MAltBvC,CAktB+C,CAC1DlM,EAAE6F,IAAF,CAAQC,OAAR,CAAiB,CACf,SAAU,sCADK,CAEf,SAAUoG,MAFK,CAGf,oBAAqBH,wBAHN,CAAjB,CAIG,SAAC9F,QAAD,CAAc,CAChB,CALD,CAMD,CAztBY,oFA2tBiBqG,KA3tBjB,CA2tBwB1G,QA3tBxB,CA2tBkC,CAC7C5F,EAAE,+BAAF,EAAmCuM,KAAnC,GACAvM,EAAE,+BAAF,EAAmCsF,MAAnC,CAA0CtF,EAAE,OAAF,EAAWwM,QAAX,CAAoB,qCAApB,CAA1C,EACAxM,EAAE,4BAAF,EAAgCwD,IAAhC,CAAqC,aAArC,EACAxD,EAAE6F,IAAF,CAAOC,OAAP,CAAgB,CACd,SAAU,4CADI,CAEd,OAAQwG,KAFM,CAAhB,CAGG,SAACrG,QAAD,CAAc,CACfjG,EAAE,sCAAF,EAA0CyM,MAA1C,GACA7G,SAASG,KAAKoE,KAAL,CAAWlE,QAAX,CAAT,CACD,CAND,CAOD,CAtuBY,0EAwuBYtF,MAxuBZ,CAwuBoBL,MAxuBpB,CAwuB4BY,IAxuB5B,CAwuBkC,CAC7C,IAAK,GAAIX,GAAI,CAAb,CAAgBA,EAAII,OAAOH,MAA3B,CAAmCD,GAAnC,CAAwC,CACtC,GAAID,SAAWK,OAAOJ,CAAP,EAAUE,QAArB,EAAiCS,OAASP,OAAOJ,CAAP,EAAUW,IAAxD,CAA8D,CAC5D,MAAOP,QAAOJ,CAAP,EAAUG,KAClB,CACF,CAED,MAAO,KACR,CAhvBY,kDAkvBA6D,MAlvBA,CAkvBQ,CACnB,GAAMmI,iBAAkB1M,EAAE,OAAF,EAAWwM,QAAX,CAAoB,iCAApB,CAAxB,CACA,GAAM3L,MAAO,KAAK8L,wBAAL,CAA8BpI,OAAOzC,KAArC,CAA4C,KAAK+I,aAAjD,CAAgE,MAAhE,CAAb,CAEA6B,gBAAgBpH,MAAhB,CACEtF,EAAE,KAAF,EACGwM,QADH,CACY,mCADZ,EAEGhJ,IAFH,CAEQ3C,IAFR,CADF,EAMA+L,OAAOC,IAAP,CAAY5M,oBAAZ,EAAkCqB,OAAlC,CAA0C,SAACgI,SAAD,CAAe,CACvD,GAAM9G,SAAUvC,qBAAqBqJ,SAArB,CAAhB,CACAoD,gBAAgBpH,MAAhB,CACEtF,EAAE,KAAF,EACGsF,MADH,CACUtF,EAAE,SAAF,EACPwM,QADO,CACE,+BADF,EAEPrD,IAFO,CAEF,CACJ,OAAO,UADH,CAEJ,qCAAsCtI,IAFlC,CAGJ,sBAAuByI,SAHnB,CAIJ,mCAAoC/E,OAAOtB,EAJvC,CAFE,CADV,EASGqC,MATH,CASUtF,EAAE,QAAF,EAAYwD,IAAZ,CAAiBhB,QAAQ1B,KAAzB,CATV,CADF,CAYD,CAdD,EAgBAd,EAAE,+BAAF,EAAmCsF,MAAnC,CAA0CoH,eAA1C,CACD,CA7wBY,sDA+wBEzG,QA/wBF,CA+wBY,CACvBjG,EAAE,+BAAF,EAAmCuM,KAAnC,GAEA,GAAItG,SAASzF,MAAT,GAAoB,CAAxB,CAA2B,CACzBR,EAAE,4BAAF,EAAgCwD,IAAhC,CAAqC,kDAArC,CACD,CAFD,IAEO,CACLxD,EAAE,4BAAF,EAAgCwD,IAAhC,CAAqC,sDAArC,CACD,CAED,IAAK,GAAIjD,GAAI,CAAb,CAAgBA,EAAI0F,SAASzF,MAA7B,CAAqCD,GAArC,CAA0C,CACxC,KAAKuM,YAAL,CAAkB7G,SAAS1F,CAAT,CAAlB,CACD,CAEF,CA5xBY,iDAgyBfR,QAAQgN,aAAR,CAAsBC,GAAtB,CAA0B,kCAA1B,CAA8D,SAAChI,MAAD,CAASiI,GAAT,CAAiB,CAC7E,GAAIrC,mCAAJ,CAAuC5F,MAAvC,EACA,GAAI+C,oCAAJ,CAAwC/C,MAAxC,CACD,CAHD,CAKD,CAryBD,EAqyBGjF,OAryBH,CAqyBYmN,MAryBZ","file":"plugin.js","sourcesContent":["/* global ajaxurl, tinymce */\n((tinymce, $) => {\n  \n  const SUPPORTED_COMPONENTS = {\n    'name': {\n      'title': 'Palvelupisteen nimi'\n    },\n    'description': {\n      'title': 'Palvelupisteen kuvaus'\n    },\n    'email': {\n      'title': 'Palvelupisteen sähköpostiosoitteet'\n    },\n    'addresses': {\n      'title': 'Palvelupisteen osoitetiedot'\n    },\n    'fax': {\n      'title': 'Palvelupisteen faksi'\n    },\n    'phone': {\n      'title': 'Palvelupisteen puhelinnumerot'\n    },\n    'servicehours': {\n      'title': 'Palvelupisteen aukioloajat'\n    },\n    'webpages': {\n      'title': 'Palvelupisteen verkkosivustot'\n    }\n  };\n  \n  class AbstractEditor {\n    \n    constructor(dialog, tab) {\n      this.dialog = dialog;\n      this.tab = tab;\n    }\n    \n    getLocalizedValue(localized, locale) {\n      for (let i = 0; i < localized.length; i++) {\n        if (localized[i].language === locale) {\n          return localized[i].value;\n        } \n      }\n      \n      return null;\n    }\n    \n    commitValue(locale, values) {\n    }\n    \n  }\n  \n  class LocalizedValueEditor extends AbstractEditor {\n    \n    constructor(dialog, tab, locale, name, title, multiline) {\n      super(dialog, tab);\n      this.locale = locale;\n      this.name = name;\n      this.title = title;\n      this.multiline = multiline;\n    }\n    \n    getEditorFields(values) {\n      const value = this.getLocalizedValue(values, this.locale);\n      return [{\n        name: `${this.name}.${this.locale}`,\n        label: `${this.title} (${this.locale})`,\n        type: 'textbox',\n        multiline: this.multiline,\n        value: value\n      }];\n    }\n    \n    commitLocalizedValue(targetList, values, name, type) {\n      const newValue = values[`${name}.${this.locale}`];\n      let valueUpdated = false;\n\n      targetList.forEach((targetItem, index) => {\n        if (targetItem.language === this.locale && (!type || type === targetItem.type)) {\n          if (newValue) {\n            targetItem.value = newValue;\n          } else {\n            targetList.splice(index, 1); \n          }\n          \n          valueUpdated = true;\n        }\n      });\n      \n      if (newValue && !valueUpdated) {\n        const newItem = {\n          value: newValue,\n          language: this.locale\n        };\n        \n        if (type) {\n          newItem.type = type;\n        }\n        \n        targetList.push(newItem);\n      }\n    }\n    \n  };\n  \n  class ServiceLocationServiceChannelNameEditor extends LocalizedValueEditor {\n    \n    constructor(dialog, tab, locale, serviceLocationServiceChannel) {\n      super(dialog, tab, locale, 'name', 'Nimi', false);\n      this.serviceLocationServiceChannel = serviceLocationServiceChannel;\n    }\n    \n    getEditorFields() {\n      return super.getEditorFields(this.serviceLocationServiceChannel.names);\n    }\n    \n    commitValue(values) {\n      super.commitLocalizedValue(this.serviceLocationServiceChannel.names, values, 'name');\n    }\n    \n  };\n  \n  class AbstractServiceLocationServiceChannelDescriptionEditor extends LocalizedValueEditor {\n    \n    constructor(dialog, tab, locale, name, title, descriptionType, serviceLocationServiceChannel) {\n      super(dialog, tab, locale, name, title, true);\n      this.serviceLocationServiceChannel = serviceLocationServiceChannel;\n      this.descriptionType = descriptionType;\n    }\n    \n    getEditorFields() {\n      return super.getEditorFields(this.serviceLocationServiceChannel.descriptions.filter((description) => {\n        return description.type === this.descriptionType;\n      }));\n    }\n    \n  };\n  \n  class ServiceLocationServiceChannelShortDescriptionEditor extends AbstractServiceLocationServiceChannelDescriptionEditor {\n\n     constructor(dialog, tab, locale, serviceLocationServiceChannel) {\n      super(dialog, tab, locale, 'short-description', 'Tiivistelmä', 'ShortDescription');\n      this.serviceLocationServiceChannel = serviceLocationServiceChannel;\n    }\n    \n    commitValue(values) {\n      super.commitLocalizedValue(this.serviceLocationServiceChannel.descriptions, values, 'short-description', 'ShortDescription');\n    }\n    \n  };\n  \n  class ServiceLocationServiceChannelDescriptionEditor extends AbstractServiceLocationServiceChannelDescriptionEditor {\n    \n    constructor(dialog, tab, locale, serviceLocationServiceChannel) {\n    super(dialog, tab, locale, 'description', 'Kuvaus', 'Description');\n      this.serviceLocationServiceChannel = serviceLocationServiceChannel;\n    }\n    \n    commitValue(values) {\n      super.commitLocalizedValue(this.serviceLocationServiceChannel.descriptions, values, 'description', 'Description');\n    }\n    \n  };\n  \n  class ServiceLocationServiceChannelAbstractMultivalueEditor extends AbstractEditor {\n    \n    constructor(dialog, tab, supportedLocales, serviceLocationServiceChannel, options) {\n      super(dialog, tab);\n      this.options = options;\n      this.index = -1;\n      this.serviceLocationServiceChannel = serviceLocationServiceChannel;\n      this.supportedLocales = supportedLocales;\n      this.dialog.on('open', this.onDialogOpen.bind(this));\n    }\n    \n    getValues() {\n      return [];  \n    }\n    \n    getEditorFields() {\n      return [\n        this.createFieldList(this.createFieldSets()),\n        this.createAddButton()\n      ];\n    }\n    \n    createFieldList(items) {\n      return {\n        label: '',\n        type: 'container',\n        layout: 'grid',\n        id: `${this.options.baseName}-list`,\n        name: `${this.options.baseName}-list`,\n        columns: 1,\n        items: items\n      };\n    }\n    \n    createFieldSets() {\n      return this.getValues().map((value) => {\n        return this.createFieldSet(value);\n      });\n    }\n    \n    createAddButton() {\n      return {\n        id: `${this.options.baseName}-add`,\n        classes: `${this.options.baseName}-add`,\n        name: `${this.options.baseName}-add`,\n        type: 'button',\n        text: this.options.addButtonText\n      };\n    }\n    \n    commitLocalizedValue(targetList, values, name, locale) {\n      const newValue = values[name];\n      let valueUpdated = false;\n      \n      targetList.forEach((targetItem, index) => {\n        if (targetItem.language === locale) {\n          if (newValue) {\n            targetItem.value = newValue;\n          } else {\n            targetList.splice(index, 1); \n          }\n          \n          valueUpdated = true;\n        }\n      });\n      \n      if (newValue && !valueUpdated) {\n        targetList.push({\n          value: newValue,\n          language: locale\n        });\n      }\n    }\n    \n    onDialogOpen() {\n      this.dialog.window.find(`#${this.options.baseName}-add`).on('click', this.onAddAddressClick.bind(this));\n    }\n    \n    onAddAddressClick(event) {\n      this.dialog.addChildItems(`#${this.options.baseName}-list`, this.createFieldSet());\n    }\n    \n  };\n  \n  class ServiceLocationServiceChannelAddressEditor extends ServiceLocationServiceChannelAbstractMultivalueEditor {\n    \n    constructor(dialog, tab, supportedLocales, serviceLocationServiceChannel) {\n      super(dialog, tab, supportedLocales, serviceLocationServiceChannel, {\n        baseName: 'address',\n        addButtonText: 'Lisää osoite'\n      });\n    }\n    \n    getValues() {\n      return this.serviceLocationServiceChannel.addresses;\n    }\n    \n    createFieldSet(value) {\n      return {\n        label: 'Osoite',\n        type: 'fieldset',\n        border: 'none',\n        layout: 'grid',\n        name: \"address\",\n        columns: 2,\n        items: this.createAddressFields(value)\n      };\n    }\n    \n    createAddressFields(address) {\n      const additionalInformation = null;\n      const streetNumber = address ? address.streetNumber : null;\n      const postalCode = address ? address.postalCode : null;\n      this.index++;\n      \n      const result = [];\n      \n      this.supportedLocales.forEach((locale) => {\n        result.push({\n          'name': this.getStreetAddressFieldName(locale, this.index),\n          'type': 'textbox',\n          'label': `Kadunnimi (${locale})`,\n          'value': address ? this.getLocalizedValue(address.streetAddress, locale) : null\n        });\n        \n        result.push({\n          'name': this.getAdditionalInformationFieldName(locale, this.index),\n          'type': 'textbox',\n          'label': `Osoitteen lisätieto (${locale})`,\n          'value': additionalInformation ? additionalInformation.value : ''\n        });\n      });\n      \n      result.push({\n        'name': this.getStreetNumberFieldName(this.index),\n        'type': 'textbox',\n        'label': 'Osoitenumero',\n        'value': streetNumber\n      });\n      \n      result.push({\n        'name': this.getPostalCodeFieldName(this.index),\n        'type': 'textbox',\n        'label': 'Postinumero',\n        'value': postalCode\n      });\n      \n      return result; \n    }\n    \n    commitValue(values) {\n      for (let index = 0; index < this.index + 1; index++) {\n        let address = this.serviceLocationServiceChannel.addresses[index];\n        if (!address) {\n          address = {};\n          this.serviceLocationServiceChannel.addresses.push(address);\n        }\n        \n        if (!address.streetAddress) {\n          address.streetAddress = [];\n        }\n        \n        if (!address.additionalInformations) {\n          address.additionalInformations = [];\n        }\n        \n        this.supportedLocales.forEach((locale) => {\n          this.commitLocalizedValue(address.streetAddress, values, this.getStreetAddressFieldName(locale, index), locale);\n          this.commitLocalizedValue(address.additionalInformations, values, this.getAdditionalInformationFieldName(locale, index), locale);\n        });\n        \n        address.streetNumber = values[this.getStreetNumberFieldName(index)];\n        address.postalCode = values[this.getPostalCodeFieldName(index)];\n      }\n    }\n    \n    getStreetAddressFieldName(locale, index) {\n      return `address-street-address-${locale}-${index}`;\n    }\n    \n    getStreetNumberFieldName(index) {\n      return `address-street-number-${index}`;\n    }\n    \n    getPostalCodeFieldName(index) {\n      return `address-postal-code-${index}`;\n    }\n    \n    getAdditionalInformationFieldName(locale, index) {\n      return `address-additional-information-${locale}-${index}`;\n    }\n    \n  };\n  \n  class ServiceLocationServiceChannelDialog {\n    \n    constructor(editor, serviceLocationServiceChannel) {\n      this.serviceLocationServiceChannel = serviceLocationServiceChannel;\n      this.dialogTitle = 'Palvelupiste';\n      this.supportedLocales = ['fi', 'en', 'sv'];\n      this.editor = editor;\n      this.listeners = [];\n      this.editors = [];\n   \n      this.supportedLocales.forEach((locale) => {\n        this.editors.push(new ServiceLocationServiceChannelNameEditor(this, `basic-${locale}`, locale, serviceLocationServiceChannel));\n        this.editors.push(new ServiceLocationServiceChannelShortDescriptionEditor(this, `basic-${locale}`, locale, serviceLocationServiceChannel));\n        this.editors.push(new ServiceLocationServiceChannelDescriptionEditor(this, `basic-${locale}`, locale, serviceLocationServiceChannel));\n      });\n\n      this.editors.push(new ServiceLocationServiceChannelAddressEditor(this, 'addresses', this.supportedLocales, serviceLocationServiceChannel));\n\n      // TODO: Kielet, joilla palvelupisteessä palvellaan\n    }\n    \n    addChildItems(selector, items) {\n      const container = this.window.find(selector)[0];\n      container.append(container.create(items)); \n    }\n    \n    getLocaleName(locale) {\n      switch (locale) {\n        case 'fi':\n          return 'Suomi';\n        case 'en':\n          return 'Englanti';\n        case 'sv':\n          return 'Ruotsi';\n      }\n    }\n    \n    createTab(name, title, items) {\n      const tabEditors = this.editors.filter((editor) => {\n        return editor.tab === name;\n      });\n\n      let tabItems = [];\n      \n      if (items) {\n        tabItems = items;\n      } else {\n        tabEditors.forEach((editor) => {\n          tabItems = tabItems.concat(editor.getEditorFields());\n        });\n      }\n      \n      return {\n        type: 'fieldset',\n        name: name,\n        title: title,\n        items: tabItems\n      };\n    }\n    \n    saveServiceLocationServiceChannel(serviceLocationServiceChannel, callback) {\n      $.post(ajaxurl, {\n        'action': 'kunta_api_save_service_location_service_channel',\n        'serviceLocationServiceChannel': JSON.stringify(this.serviceLocationServiceChannel)\n      }, (response) => {\n        callback();\n      })\n      .fail((response) => {\n        callback(response.responseText || response.statusText);\n      });\n    }\n    \n    open() {\n      let tabs = [];\n      const contactSubtabs = [];\n \n      contactSubtabs.push(this.createTab('emails', 'Sähköpostit'));\n      contactSubtabs.push(this.createTab('fax', 'Faksit'));\n      contactSubtabs.push(this.createTab('phone', 'Puhelimet'));\n      contactSubtabs.push(this.createTab('web', 'Verkkosivut'));\n      \n      tabs.push(this.createTab('common', 'Yleiset'));\n      \n      this.supportedLocales.forEach((locale) => {\n        tabs.push(this.createTab(`basic-${locale}`, `Perustiedot (${locale})`));\n      });\n      \n      tabs.push(this.createTab('addresses', 'Osoitteet'));\n      tabs.push(this.createTab('times', 'Palveluajat'));\n      tabs.push(this.createTab('contacts', 'Yhteystiedot', contactSubtabs));\n      \n      this.window = this.editor.windowManager.open({\n        title: this.dialogTitle,\n        body: [{\n          id: 'dialog-form',\n          type: 'form',\n          items: [{\n            name: 'locales',\n            type: 'tabpanel',\n            layout: 'fit',\n            items: tabs\n          }]\n        }],\n        width: 1000,\n        height: 700,\n        buttons: [{\n          text: 'Tallenna',\n          subtype: 'save',\n          onclick: (event) => {\n            const dialogForm = this.window.find('form').filter((form) => {\n              return form.settings.id === 'dialog-form';\n            })[0];\n            \n            const values = dialogForm.toJSON();\n            this.editors.forEach((editor) => {\n              editor.commitValue(values);\n            });\n            \n            this.saveServiceLocationServiceChannel(this.serviceLocationServiceChannel, (err) => {\n              if (err) {\n                tinyMCE.activeEditor.windowManager.alert(err);\n              }\n            });\n          }\n        }, {\n          text: 'Peruuta', \n          onclick: () => {\n            this.window.close();\n          }\n        }]\n      });\n      \n      this.trigger('open');\n    }\n    \n    trigger (event, data) {\n      this.listeners.forEach((listener) => {\n        if (listener.event === event) {\n          listener.callable(data||{});\n        }\n      });\n    }\n    \n    on (event, callable) {\n      this.listeners.push({\n        event: event,\n        callable: callable\n      });\n    }\n    \n  }\n  \n  class ServiceLocationServiceChannelEditor {\n    \n    constructor (editor) {\n      this.buttonStyle = {\n        'color': '#555',\n        'width': '100%',\n        'border': '1px solid #ccc',\n        'background': '#f7f7f7',\n        'display': 'block',\n        'padding': '5px',\n        'margin-top': '5px',\n        'margin-bottom': '5px',\n        'cursor': 'pointer'\n      };\n      \n      this.editor = editor;\n      \n      this.editor.on('BeforeSetcontent', this.onBeforeSetcontent.bind(this));\n      this.editor.on('GetContent', this.onGetContent.bind(this));\n      this.editor.on('DblClick', this.onDblClick.bind(this));\n      this.editor.addCommand('kunta-api-service-location-channel-edit', this.onServiceLocationChannelEdit.bind(this));\n    }\n    \n    parseAttributes (string) {\n      const result = [];\n      const re = /([a-zA-Z-_]*)(\\=\\\")([a-zA-Z0-9-]*)(\\\")/g;\n      let match = null;\n      \n      do {\n        match = re.exec(string);\n        if (match && match.length > 3) {\n          result.push({\n            name: match[1],\n            value: match[3] \n          });\n        }\n      } while (match);\n\n      return result;\n    }\n    \n    getComponentTitle (name) {\n      return SUPPORTED_COMPONENTS[name].title;\n    }\n    \n    replaceShortcodes(content) {\n      return content.replace(/(\\[kunta_api_location_channel_component)([a-zA-Z0-9 -=]*)(\\])/g, (all, tag, attributesText, end) => {\n        const attributes = this.parseAttributes(attributesText);\n        const placeholder = $('<input>')\n          .attr({\n           'type': 'button',\n           'data-kunta-api-placeholder': 'location_channel_component'\n          })\n          .css(this.buttonStyle);\n          \n        for (let i = 0; i < attributes.length; i++) {\n          const attribute = attributes[i];\n          placeholder.attr('data-' + attribute.name, attribute.value);\n        }\n        \n        const component = placeholder.attr('data-component');\n        if (!SUPPORTED_COMPONENTS[component]) {\n          return all;\n        }\n        \n        placeholder.attr('value', this.getComponentTitle(component));\n        return $('<div>').append(placeholder).html();\n      });\n      \n    }\n    \n    restoreShortcodes(content) {\n      return content.replace(/<input [^>]+>/g, (match) => {\n        const input = $(match);\n        \n        if (input.attr('data-kunta-api-placeholder') === 'location_channel_component') {\n          const shortcodeAttributes = [];\n          const attributeNames = ['channel-id', 'component'];\n          \n          for (let i = 0; i < attributeNames.length; i++) {\n            const attributeName = attributeNames[i];\n            const attributeValue = input.attr('data-' + attributeName);\n            shortcodeAttributes.push([attributeName, '\"' + attributeValue + '\"'].join('='));\n          }\n          \n          return '[kunta_api_location_channel_component ' + shortcodeAttributes.join(' ') + ']';\n        }\n        \n        return match;\n      });\n    }\n    \n    openElementEditor(element) {\n      const placeholderAttr = element.attributes['data-kunta-api-placeholder'];\n      if (placeholderAttr) {\n        const serviceLocationServiceChannelId = element.attributes['data-channel-id'].value;\n        this.editor.execCommand('kunta-api-service-location-channel-edit', '', {\n          serviceLocationServiceChannelId: serviceLocationServiceChannelId\n        });\n      }\n    }\n    \n    findServiceLocationServiceChannel(id, callback) {\n      $.post(ajaxurl, {\n        'action': 'kunta_api_load_service_location_service_channel',\n        'serviceLocationServiceChannelId': id\n      }, (response) => {\n        callback(null, JSON.parse(response));\n      })\n      .fail((response) => {\n        callback(response.responseText || response.statusText);\n      });\n    }\n      \n    onBeforeSetcontent(event) {\n      event.content = this.replaceShortcodes(event.content);\n    }\n    \n    onGetContent(event) {\n      event.content = this.restoreShortcodes(event.content);\n    }\n    \n    onDblClick(event) {\n      const element = event.target;\n      this.openElementEditor(element);\n    }\n\n    onServiceLocationChannelEdit(ui, options) {\n      this.findServiceLocationServiceChannel(options.serviceLocationServiceChannelId, (err, serviceLocationServiceChannel) => {\n        console.log(err, serviceLocationServiceChannel);\n        \n        if (err) {\n          tinyMCE.activeEditor.windowManager.alert(err);\n        } else {\n          const dialog = new ServiceLocationServiceChannelDialog(this.editor, serviceLocationServiceChannel);\n          dialog.open();\n        }\n      });\n    } \n    \n  }\n  \n  class ServiceLocationServiceChannelEmbed {\n    \n    constructor (editor) {\n      this.editor = editor;\n      this.displayLocale = 'fi';\n      this.searching = false;\n      this.pending = false;\n      this.addButton();\n    }\n    \n    addButton () {\n      this.editor.addButton('kunta_api_service_location_embed', {\n        title: 'Search Kunta API service location channels',\n        onclick: () => {\n          this.editor.windowManager.open({\n            title: 'Search Kunta API service location channels',\n            width: 768,\n            height: 500,\n            body: [\n              { type: 'textbox', name: 'kunta-api-service-query', label: 'Query', onKeyUp: (e) => {     \n                if (!this.searching) {\n                  this.searching = true;\n                  this.searchServiceLocationChannels(e.target.value, (response) => {\n                    this.searching = false;\n                    if (this.pending) {\n                      this.searchServiceLocationChannels(e.target.value, (innerResponse) => {\n                        this.handleResponse(innerResponse);\n                      });\n                    } else {\n                      this.handleResponse(response);\n                    }\n                  });\n                } else {\n                  this.pending = true;\n                }\n              }},\n              {type: 'label', classes: 'kunta-api-search-info', text: \"Kirjoita hakusana yllä olevaan hakukenttään\"},\n              {type: 'container', classes: 'kunta-api-search-results', minHeight: 400}\n            ],\n            onsubmit: (e) => {\n              let responseHtml = '';\n              let allEmbedsFromSameChannel = true;              \n              const componentsToEmbed = $('.service-component-embed-input:checked');\n              const firstServiceLocationChannelId = componentsToEmbed.first().attr('data-service-location-channel-id');\n              const serviceLocationChannelName = componentsToEmbed.first().attr('data-service-location-channel-name');\n              \n              componentsToEmbed.each(function () {\n                var component = $(this).attr('data-component-type');\n                var serviceLocationChannelId = $(this).attr('data-service-location-channel-id');\n                responseHtml += '[kunta_api_location_channel_component channel-id=\"'+ serviceLocationChannelId +'\" component=\"'+ component +'\"]';\n                if (serviceLocationChannelId !== firstServiceLocationChannelId) {\n                  allEmbedsFromSameChannel = false;\n                }\n              });\n\n              if (allEmbedsFromSameChannel) {\n                this.editor.windowManager.confirm(\"Merkitäänkö sivu palvelukanavan: \"+ serviceLocationChannelName + \" sivuksi?\", function(confirmed) {\n                  if (confirmed) {\n                    const pageId = $('#post_ID').val();\n                    this.markAsServiceLocationPage(firstServiceLocationChannelId, pageId);\n                  }\n                });\n              }\n\n              this.editor.insertContent(responseHtml);\n            }\n          });\n        }\n      });\n    }\n    \n    markAsServiceLocationPage(serviceLocationChannelId, pageId) {\n      $.post( ajaxurl, {\n        'action': 'kunta_api_mark_page_as_location_page',\n        'pageId': pageId,\n        'locationChannelId': serviceLocationChannelId\n      }, (response) => {\n      });\n    }\n    \n    searchServiceLocationChannels(query, callback) {\n      $('.mce-kunta-api-search-results').empty();\n      $('.mce-kunta-api-search-results').append($('<div>').addClass('mce-kunta-api-search-results-loader'));\n      $('.mce-kunta-api-search-info').text('Ladataan...');\n      $.post(ajaxurl, {\n        'action': 'kunta_api_search_service_location_channels',\n        'data': query\n      }, (response) => {\n        $('.mce-kunta-api-search-results-loader').remove();\n        callback(JSON.parse(response));\n      });\n    }\n    \n    getLocalizedValueAndType(values, locale, type) {\n      for (let i = 0; i < values.length; i++) {\n        if (locale === values[i].language && type === values[i].type) {\n          return values[i].value;\n        }\n      }\n      \n      return null;\n    }\n    \n    appendResult(result) {\n      const resultContainer = $('<div>').addClass('mce-kunta-api-search-result-row');\n      const name = this.getLocalizedValueAndType(result.names, this.displayLocale, 'Name');\n\n      resultContainer.append(\n        $('<p>')\n          .addClass('mce-kunta-api-search-result-title')\n          .text(name)\n      );\n      \n      Object.keys(SUPPORTED_COMPONENTS).forEach((component) => {\n        const options = SUPPORTED_COMPONENTS[component]; \n        resultContainer.append(\n          $('<p>')\n            .append($('<input>')\n            .addClass('service-component-embed-input')\n            .attr({\n              'type':'checkbox',\n              'data-service-location-channel-name': name,\n              'data-component-type': component,\n              'data-service-location-channel-id': result.id\n            }))\n            .append($('<span>').text(options.title))\n        );\n      });\n      \n      $('.mce-kunta-api-search-results').append(resultContainer);\n    }\n    \n    handleResponse(response) {\n      $('.mce-kunta-api-search-results').empty();\n\n      if (response.length === 0) {\n        $('.mce-kunta-api-search-info').text('Hakusanalla ei löytynyt yhtään palvelua');\n      } else {\n        $('.mce-kunta-api-search-info').text('Kirjoita hakusana yllä olevaan hakukenttään');\n      }\n\n      for (let i = 0; i < response.length; i++) {\n        this.appendResult(response[i]);\n      }\n\n    }\n    \n  }\n  \n  tinymce.PluginManager.add('kunta_api_service_location_embed', (editor, url) => {\n    new ServiceLocationServiceChannelEmbed(editor);\n    new ServiceLocationServiceChannelEditor(editor);\n  });\n  \n})(tinymce, jQuery);"]}